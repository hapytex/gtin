<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621679062636"><span id="local-6989586621679062637"></span></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskellQuotes #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span class="hs-cpp">
#if !MIN_VERSION_base(4,17,1)
</span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span class="hs-cpp">
#endif
</span><span class="hs-pragma">{-# OPTIONS_GHC -Wall -fno-warn-redundant-constraints #-}</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Module      : Data.Trade.GTIN</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Description : A module to parse, render and manipulate GTIN codes used for trade and EAN barcodes.</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Maintainer  : hapytexeu+gh@gmail.com</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- Portability : POSIX</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- The module exposes a 'GTIN' data type that contains the number of digits as well.</span><span>
</span><span id="line-24"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Trade.GTIN</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * GTIN and its aliasses.</span></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier">GTIN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier">GTIN</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#gtin"><span class="hs-identifier">gtin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN14"><span class="hs-identifier">GTIN14</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN13"><span class="hs-identifier">GTIN13</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN12"><span class="hs-identifier">GTIN12</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN8"><span class="hs-identifier">GTIN8</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#EANUCC14"><span class="hs-identifier">EANUCC14</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#SCC14"><span class="hs-identifier">SCC14</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#EAN"><span class="hs-identifier">EAN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#EANUCC13"><span class="hs-identifier">EANUCC13</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#ISBN"><span class="hs-identifier">ISBN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#ISBN13"><span class="hs-identifier">ISBN13</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#EANUCC8"><span class="hs-identifier">EANUCC8</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#GSIN"><span class="hs-identifier">GSIN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#SSCC"><span class="hs-identifier">SSCC</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Check if two GTINs are equivalent, even if the &quot;width&quot; of the GTINs are equivalent.</span></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#equivGTIN"><span class="hs-identifier">equivGTIN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#upscaleGTIN"><span class="hs-identifier">upscaleGTIN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Fix the checksum of a GTIN number</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#fixChecksum"><span class="hs-identifier">fixChecksum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#checkChecksum"><span class="hs-identifier">checkChecksum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Convert the GTINs to a readable format.</span></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#gtinToString"><span class="hs-identifier">gtinToString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-comment">-- * ISBN-10 to ISBN-13</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#fromISBN10%27"><span class="hs-identifier">fromISBN10'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Parsing GTINs</span></span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#gtinParser"><span class="hs-identifier">gtinParser</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#gtinParser_"><span class="hs-identifier">gtinParser_</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#gtinParser%27"><span class="hs-identifier">gtinParser'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#gtinParser_%27"><span class="hs-identifier">gtinParser_'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#parseGTIN"><span class="hs-identifier">parseGTIN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#parseGTIN_"><span class="hs-identifier">parseGTIN_</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#parseGTIN%27"><span class="hs-identifier">parseGTIN'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#parseGTIN_%27"><span class="hs-identifier">parseGTIN_'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="hs-comment">-- * QuasiQuoters</span></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#gtinQ"><span class="hs-identifier">gtinQ</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#gtin14Q"><span class="hs-identifier">gtin14Q</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#gtin13Q"><span class="hs-identifier">gtin13Q</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#gtin12Q"><span class="hs-identifier">gtin12Q</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#gtin8Q"><span class="hs-identifier">gtin8Q</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#eanucc8Q"><span class="hs-identifier">eanucc8Q</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#eanucc14Q"><span class="hs-identifier">eanucc14Q</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#scc14Q"><span class="hs-identifier">scc14Q</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#eanQ"><span class="hs-identifier">eanQ</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#eanucc13Q"><span class="hs-identifier">eanucc13Q</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#gsinQ"><span class="hs-identifier">gsinQ</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#ssccQ"><span class="hs-identifier">ssccQ</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#isbnQ"><span class="hs-identifier">isbnQ</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="Data.Trade.GTIN.html#isbn13Q"><span class="hs-identifier">isbn13Q</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">where</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&gt;=&gt;)</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if !MIN_VERSION_base(4,13,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Fail</span><span class="hs-special">(</span><span class="hs-identifier">MonadFail</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Binary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Binary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">put</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">chr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">digitToInt</span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Data</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Identity</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Hashable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Hashable</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unfoldr</span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Typeable</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if MIN_VERSION_validity(0,9,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Validity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Validity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">validate</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">check</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">prettyValidate</span></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Validity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Validation</span><span class="hs-special">(</span><span class="hs-identifier">Validation</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Validity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">validate</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">check</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word64</span></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if MIN_VERSION_base(4,16,4)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Natural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Natural</span></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Types</span><span class="hs-special">(</span><span class="hs-identifier">Nat</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeNats</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">KnownNat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">natVal</span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeNats</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TN</span></span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Quote</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">QuasiQuoter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">QuasiQuoter</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">quoteDec</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">quoteExp</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">quotePat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">quoteType</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck.Arbitrary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Arbitrary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">arbitrary</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck.Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">choose</span></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Parsec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ParseError</span></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Parsec.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">digit</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">space</span></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Parsec.Combinator</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">eof</span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Parsec.Prim</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ParsecT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Stream</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runParser</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">skipMany</span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Printf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PrintfArg</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">printf</span></span><span class="hs-special">)</span><span class="hs-cpp">

#if MIN_VERSION_template_haskell(2, 17, 0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Code</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Code</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Exp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">AppE</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ConE</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">LitE</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftTyped</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Lit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IntegerL</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Pat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ConP</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">LitP</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TExp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TExp</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#elif MIN_VERSION_template_haskell(2, 16, 0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Syntax</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Exp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AppE</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ConE</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LitE</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Lift</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lift</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">liftTyped</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Lit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IntegerL</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Pat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ConP</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LitP</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">TExp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">TExp</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Syntax</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Exp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AppE</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ConE</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LitE</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Lift</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lift</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Lit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IntegerL</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Pat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ConP</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LitP</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_base(4,16,4)
</span><span class="annot"><span class="hs-comment">-- | A datatype for /Global Trade Item Numbers 'GTIN'/ with arbitrary &quot;width&quot; (up to nineteen digits technically possible).</span></span><span>
</span><span id="line-129"></span><span class="hs-keyword">newtype</span><span> </span><span id="GTIN"><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062741"><span class="annot"><a href="#local-6989586621679062741"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GTIN"><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062748"><span id="local-6989586621679062752"><span id="local-6989586621679062755"><span id="local-6989586621679062757"><span id="local-6989586621679062759"><span id="local-6989586621679062765"><span id="local-6989586621679062770"><span id="local-6989586621679062773"><span id="local-6989586621679062776"><span id="local-6989586621679062779"><span id="local-6989586621679062782"><span id="local-6989586621679062785"><span id="local-6989586621679062790"><span id="local-6989586621679062795"><span class="annot"><span class="annottext">Typeable (GTIN n)
Typeable (GTIN n)
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; GTIN n -&gt; c (GTIN n))
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (GTIN n))
-&gt; (GTIN n -&gt; Constr)
-&gt; (GTIN n -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (GTIN n)))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c (GTIN n)))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; GTIN n -&gt; GTIN n)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; GTIN n -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; GTIN n -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; GTIN n -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; GTIN n -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; GTIN n -&gt; m (GTIN n))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; GTIN n -&gt; m (GTIN n))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; GTIN n -&gt; m (GTIN n))
-&gt; Data (GTIN n)
GTIN n -&gt; Constr
GTIN n -&gt; DataType
(forall b. Data b =&gt; b -&gt; b) -&gt; GTIN n -&gt; GTIN n
forall {n :: Natural}. KnownNat n =&gt; Typeable (GTIN n)
forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; Constr
forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; DataType
forall (n :: Natural).
KnownNat n =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; GTIN n -&gt; GTIN n
forall (n :: Natural) u.
KnownNat n =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; GTIN n -&gt; u
forall (n :: Natural) u.
KnownNat n =&gt;
(forall d. Data d =&gt; d -&gt; u) -&gt; GTIN n -&gt; [u]
forall (n :: Natural) r r'.
KnownNat n =&gt;
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; GTIN n -&gt; r
forall (n :: Natural) r r'.
KnownNat n =&gt;
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; GTIN n -&gt; r
forall (n :: Natural) (m :: * -&gt; *).
(KnownNat n, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; GTIN n -&gt; m (GTIN n)
forall (n :: Natural) (m :: * -&gt; *).
(KnownNat n, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; GTIN n -&gt; m (GTIN n)
forall (n :: Natural) (c :: * -&gt; *).
KnownNat n =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (GTIN n)
forall (n :: Natural) (c :: * -&gt; *).
KnownNat n =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; GTIN n -&gt; c (GTIN n)
forall (n :: Natural) (t :: * -&gt; *) (c :: * -&gt; *).
(KnownNat n, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (GTIN n))
forall (n :: Natural) (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(KnownNat n, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c (GTIN n))
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; GTIN n -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; GTIN n -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; GTIN n -&gt; r
forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; GTIN n -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; GTIN n -&gt; m (GTIN n)
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; GTIN n -&gt; m (GTIN n)
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (GTIN n)
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; GTIN n -&gt; c (GTIN n)
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (GTIN n))
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c (GTIN n))
$cgfoldl :: forall (n :: Natural) (c :: * -&gt; *).
KnownNat n =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; GTIN n -&gt; c (GTIN n)
gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; GTIN n -&gt; c (GTIN n)
$cgunfold :: forall (n :: Natural) (c :: * -&gt; *).
KnownNat n =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (GTIN n)
gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (GTIN n)
$ctoConstr :: forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; Constr
toConstr :: GTIN n -&gt; Constr
$cdataTypeOf :: forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; DataType
dataTypeOf :: GTIN n -&gt; DataType
$cdataCast1 :: forall (n :: Natural) (t :: * -&gt; *) (c :: * -&gt; *).
(KnownNat n, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (GTIN n))
dataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (GTIN n))
$cdataCast2 :: forall (n :: Natural) (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(KnownNat n, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c (GTIN n))
dataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c (GTIN n))
$cgmapT :: forall (n :: Natural).
KnownNat n =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; GTIN n -&gt; GTIN n
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; GTIN n -&gt; GTIN n
$cgmapQl :: forall (n :: Natural) r r'.
KnownNat n =&gt;
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; GTIN n -&gt; r
gmapQl :: forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; GTIN n -&gt; r
$cgmapQr :: forall (n :: Natural) r r'.
KnownNat n =&gt;
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; GTIN n -&gt; r
gmapQr :: forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; GTIN n -&gt; r
$cgmapQ :: forall (n :: Natural) u.
KnownNat n =&gt;
(forall d. Data d =&gt; d -&gt; u) -&gt; GTIN n -&gt; [u]
gmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; GTIN n -&gt; [u]
$cgmapQi :: forall (n :: Natural) u.
KnownNat n =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; GTIN n -&gt; u
gmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; GTIN n -&gt; u
$cgmapM :: forall (n :: Natural) (m :: * -&gt; *).
(KnownNat n, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; GTIN n -&gt; m (GTIN n)
gmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; GTIN n -&gt; m (GTIN n)
$cgmapMp :: forall (n :: Natural) (m :: * -&gt; *).
(KnownNat n, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; GTIN n -&gt; m (GTIN n)
gmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; GTIN n -&gt; m (GTIN n)
$cgmapMo :: forall (n :: Natural) (m :: * -&gt; *).
(KnownNat n, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; GTIN n -&gt; m (GTIN n)
gmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; GTIN n -&gt; m (GTIN n)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062801"><span id="local-6989586621679062806"><span class="annot"><span class="annottext">GTIN n -&gt; GTIN n -&gt; Bool
(GTIN n -&gt; GTIN n -&gt; Bool)
-&gt; (GTIN n -&gt; GTIN n -&gt; Bool) -&gt; Eq (GTIN n)
forall (n :: Natural). GTIN n -&gt; GTIN n -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall (n :: Natural). GTIN n -&gt; GTIN n -&gt; Bool
== :: GTIN n -&gt; GTIN n -&gt; Bool
$c/= :: forall (n :: Natural). GTIN n -&gt; GTIN n -&gt; Bool
/= :: GTIN n -&gt; GTIN n -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062812"><span id="local-6989586621679062814"><span class="annot"><span class="annottext">(forall x. GTIN n -&gt; Rep (GTIN n) x)
-&gt; (forall x. Rep (GTIN n) x -&gt; GTIN n) -&gt; Generic (GTIN n)
forall (n :: Natural) x. Rep (GTIN n) x -&gt; GTIN n
forall (n :: Natural) x. GTIN n -&gt; Rep (GTIN n) x
forall x. Rep (GTIN n) x -&gt; GTIN n
forall x. GTIN n -&gt; Rep (GTIN n) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall (n :: Natural) x. GTIN n -&gt; Rep (GTIN n) x
from :: forall x. GTIN n -&gt; Rep (GTIN n) x
$cto :: forall (n :: Natural) x. Rep (GTIN n) x -&gt; GTIN n
to :: forall x. Rep (GTIN n) x -&gt; GTIN n
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062820"><span id="local-6989586621679062825"><span id="local-6989586621679062829"><span id="local-6989586621679062833"><span id="local-6989586621679062837"><span id="local-6989586621679062841"><span id="local-6989586621679062845"><span class="annot"><span class="annottext">Eq (GTIN n)
Eq (GTIN n)
-&gt; (GTIN n -&gt; GTIN n -&gt; Ordering)
-&gt; (GTIN n -&gt; GTIN n -&gt; Bool)
-&gt; (GTIN n -&gt; GTIN n -&gt; Bool)
-&gt; (GTIN n -&gt; GTIN n -&gt; Bool)
-&gt; (GTIN n -&gt; GTIN n -&gt; Bool)
-&gt; (GTIN n -&gt; GTIN n -&gt; GTIN n)
-&gt; (GTIN n -&gt; GTIN n -&gt; GTIN n)
-&gt; Ord (GTIN n)
GTIN n -&gt; GTIN n -&gt; Bool
GTIN n -&gt; GTIN n -&gt; Ordering
GTIN n -&gt; GTIN n -&gt; GTIN n
forall (n :: Natural). Eq (GTIN n)
forall (n :: Natural). GTIN n -&gt; GTIN n -&gt; Bool
forall (n :: Natural). GTIN n -&gt; GTIN n -&gt; Ordering
forall (n :: Natural). GTIN n -&gt; GTIN n -&gt; GTIN n
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: forall (n :: Natural). GTIN n -&gt; GTIN n -&gt; Ordering
compare :: GTIN n -&gt; GTIN n -&gt; Ordering
$c&lt; :: forall (n :: Natural). GTIN n -&gt; GTIN n -&gt; Bool
&lt; :: GTIN n -&gt; GTIN n -&gt; Bool
$c&lt;= :: forall (n :: Natural). GTIN n -&gt; GTIN n -&gt; Bool
&lt;= :: GTIN n -&gt; GTIN n -&gt; Bool
$c&gt; :: forall (n :: Natural). GTIN n -&gt; GTIN n -&gt; Bool
&gt; :: GTIN n -&gt; GTIN n -&gt; Bool
$c&gt;= :: forall (n :: Natural). GTIN n -&gt; GTIN n -&gt; Bool
&gt;= :: GTIN n -&gt; GTIN n -&gt; Bool
$cmax :: forall (n :: Natural). GTIN n -&gt; GTIN n -&gt; GTIN n
max :: GTIN n -&gt; GTIN n -&gt; GTIN n
$cmin :: forall (n :: Natural). GTIN n -&gt; GTIN n -&gt; GTIN n
min :: GTIN n -&gt; GTIN n -&gt; GTIN n
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062851"><span id="local-6989586621679062855"><span id="local-6989586621679062858"><span id="local-6989586621679062866"><span class="annot"><span class="annottext">ReadPrec [GTIN n]
ReadPrec (GTIN n)
Int -&gt; ReadS (GTIN n)
ReadS [GTIN n]
(Int -&gt; ReadS (GTIN n))
-&gt; ReadS [GTIN n]
-&gt; ReadPrec (GTIN n)
-&gt; ReadPrec [GTIN n]
-&gt; Read (GTIN n)
forall (n :: Natural). ReadPrec [GTIN n]
forall (n :: Natural). ReadPrec (GTIN n)
forall (n :: Natural). Int -&gt; ReadS (GTIN n)
forall (n :: Natural). ReadS [GTIN n]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: forall (n :: Natural). Int -&gt; ReadS (GTIN n)
readsPrec :: Int -&gt; ReadS (GTIN n)
$creadList :: forall (n :: Natural). ReadS [GTIN n]
readList :: ReadS [GTIN n]
$creadPrec :: forall (n :: Natural). ReadPrec (GTIN n)
readPrec :: ReadPrec (GTIN n)
$creadListPrec :: forall (n :: Natural). ReadPrec [GTIN n]
readListPrec :: ReadPrec [GTIN n]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- | A datatype for /Global Trade Item Numbers 'GTIN'/ with arbitrary &quot;width&quot; (up to nineteen digits technically possible).</span><span>
</span><span id="line-132"></span><span class="hs-keyword">newtype</span><span> </span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Nat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">Word64</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Data</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Typeable</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-135"></span><span id="local-6989586621679062346"><span class="annot"><a href="Data.Trade.GTIN.html#_hole"><span class="hs-identifier hs-type">_hole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062346"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-136"></span><span id="_hole"><span class="annot"><span class="annottext">_hole :: forall (n :: Natural). GTIN n
</span><a href="Data.Trade.GTIN.html#_hole"><span class="hs-identifier hs-var hs-var">_hole</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; GTIN n
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;should not be evaluated&quot;</span></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span id="local-6989586621679062351"><span class="annot"><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-type">_fromEnum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062351"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span></span><span>
</span><span id="line-139"></span><span id="_fromEnum"><span class="annot"><span class="annottext">_fromEnum :: forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var hs-var">_fromEnum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679062876"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679062876"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679062876"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span id="local-6989586621679062354"><span class="annot"><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-type">_toEnum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062354"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-142"></span><span id="_toEnum"><span class="annot"><span class="annottext">_toEnum :: forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var hs-var">_toEnum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; GTIN n
forall (n :: Natural). GTIN n -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#fixChecksum"><span class="hs-identifier hs-var">fixChecksum</span></a></span><span> </span><span class="annot"><span class="annottext">(GTIN n -&gt; GTIN n) -&gt; (Word64 -&gt; GTIN n) -&gt; Word64 -&gt; GTIN n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; GTIN n) -&gt; (Word64 -&gt; Word64) -&gt; Word64 -&gt; GTIN n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="annot"><span class="hs-comment">-- | Constructing a 'GTIN&quot; with bound and checksum checks.</span></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Data.Trade.GTIN.html#gtin"><span class="hs-identifier hs-type">gtin</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679062362"><span class="annot"><a href="#local-6989586621679062362"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679062361"><span class="annot"><a href="#local-6989586621679062361"><span class="hs-identifier hs-type">n</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><a href="#local-6989586621679062361"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679062362"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062361"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><span class="hs-comment">-- | An 'Integral' value for which we want to construct a 'GTIN' number.</span></span><span>
</span><span id="line-149"></span><span>  </span><span class="annot"><a href="#local-6989586621679062362"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><span class="hs-comment">-- | A 'GTIN' number wrapped in a 'Just' if the given value is within bounds and the checksum matches; 'Nothing' otherwise.</span></span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062361"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span id="gtin"><span class="annot"><span class="annottext">gtin :: forall i (n :: Natural).
(n &lt;= 19, Integral i, KnownNat n) =&gt;
i -&gt; Maybe (GTIN n)
</span><a href="Data.Trade.GTIN.html#gtin"><span class="hs-identifier hs-var hs-var">gtin</span></a></span></span><span> </span><span id="local-6989586621679062901"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062901"><span class="hs-identifier hs-var">v''</span></a></span></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062903"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062903"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062905"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">GTIN Any -&gt; Bool
forall (n :: Natural). GTIN n -&gt; Bool
</span><a href="Data.Trade.GTIN.html#checkChecksum"><span class="hs-identifier hs-var">checkChecksum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN Any
forall (n :: Natural). GTIN n
</span><a href="#local-6989586621679062906"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Maybe (GTIN n)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">GTIN n
forall (n :: Natural). GTIN n
</span><a href="#local-6989586621679062906"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (GTIN n)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621679062903"><span class="annot"><span class="annottext">v' :: Integer
</span><a href="#local-6989586621679062903"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">i -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062901"><span class="hs-identifier hs-var">v''</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621679062906"><span class="annot"><span class="annottext">v :: GTIN n
</span><a href="#local-6989586621679062906"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062903"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679062905"><span class="annot"><span class="annottext">m :: Integer
</span><a href="#local-6989586621679062905"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Integer
forall i (n :: Natural). (Integral i, KnownNat n) =&gt; GTIN n -&gt; i
</span><a href="Data.Trade.GTIN.html#_maxBound"><span class="hs-identifier hs-var">_maxBound</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n
forall (n :: Natural). GTIN n
</span><a href="Data.Trade.GTIN.html#_hole"><span class="hs-identifier hs-var">_hole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062361"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span id="local-6989586621679062373"><span class="annot"><a href="Data.Trade.GTIN.html#_decw"><span class="hs-identifier hs-type">_decw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062373"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062373"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-161"></span><span id="_decw"><span class="annot"><span class="annottext">_decw :: forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; Int
</span><a href="Data.Trade.GTIN.html#_decw"><span class="hs-identifier hs-var hs-var">_decw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Int) -&gt; (GTIN n -&gt; Natural) -&gt; GTIN n -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Natural
forall (n :: Natural) (proxy :: Natural -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Natural
</span><span class="hs-identifier hs-var">natVal</span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span id="local-6989586621679062935"><span class="annot"><a href="Data.Trade.GTIN.html#_decw%27"><span class="hs-identifier hs-type">_decw'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062935"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062935"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-164"></span><span id="_decw%27"><span class="annot"><span class="annottext">_decw' :: forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; Int
</span><a href="Data.Trade.GTIN.html#_decw%27"><span class="hs-identifier hs-var hs-var">_decw'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; (GTIN n -&gt; Int) -&gt; GTIN n -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Int
forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; Int
</span><a href="Data.Trade.GTIN.html#_decw"><span class="hs-identifier hs-var">_decw</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span id="local-6989586621679062942"><span id="local-6989586621679062943"><span class="annot"><a href="Data.Trade.GTIN.html#_maxBound%27"><span class="hs-identifier hs-type">_maxBound'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679062942"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062943"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062943"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062942"><span class="hs-identifier hs-type">i</span></a></span></span></span><span>
</span><span id="line-167"></span><span id="_maxBound%27"><span class="annot"><span class="annottext">_maxBound' :: forall i (n :: Natural). (Integral i, KnownNat n) =&gt; GTIN n -&gt; i
</span><a href="Data.Trade.GTIN.html#_maxBound%27"><span class="hs-identifier hs-var hs-var">_maxBound'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; Int -&gt; i
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; i) -&gt; (GTIN n -&gt; Int) -&gt; GTIN n -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Int
forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; Int
</span><a href="Data.Trade.GTIN.html#_decw"><span class="hs-identifier hs-var">_decw</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span id="local-6989586621679062955"><span id="local-6989586621679062956"><span class="annot"><a href="Data.Trade.GTIN.html#_maxBound%27%27"><span class="hs-identifier hs-type">_maxBound''</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679062955"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062956"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062956"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062955"><span class="hs-identifier hs-type">i</span></a></span></span></span><span>
</span><span id="line-170"></span><span id="_maxBound%27%27"><span class="annot"><span class="annottext">_maxBound'' :: forall i (n :: Natural). (Integral i, KnownNat n) =&gt; GTIN n -&gt; i
</span><a href="Data.Trade.GTIN.html#_maxBound%27%27"><span class="hs-identifier hs-var hs-var">_maxBound''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; Int -&gt; i
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; i) -&gt; (GTIN n -&gt; Int) -&gt; GTIN n -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Int
forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; Int
</span><a href="Data.Trade.GTIN.html#_decw%27"><span class="hs-identifier hs-var">_decw'</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span id="local-6989586621679062371"><span id="local-6989586621679062372"><span class="annot"><a href="Data.Trade.GTIN.html#_maxBound"><span class="hs-identifier hs-type">_maxBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679062371"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062372"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062372"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062371"><span class="hs-identifier hs-type">i</span></a></span></span></span><span>
</span><span id="line-173"></span><span id="_maxBound"><span class="annot"><span class="annottext">_maxBound :: forall i (n :: Natural). (Integral i, KnownNat n) =&gt; GTIN n -&gt; i
</span><a href="Data.Trade.GTIN.html#_maxBound"><span class="hs-identifier hs-var hs-var">_maxBound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">i -&gt; i
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">(i -&gt; i) -&gt; (GTIN n -&gt; i) -&gt; GTIN n -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; i
forall i (n :: Natural). (Integral i, KnownNat n) =&gt; GTIN n -&gt; i
</span><a href="Data.Trade.GTIN.html#_maxBound%27"><span class="hs-identifier hs-var">_maxBound'</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="annot"><span class="hs-comment">-- | values without checksum digit (so divided by ten)</span></span><span>
</span><span id="line-176"></span><span id="local-6989586621679062387"><span id="local-6989586621679062388"><span class="annot"><a href="Data.Trade.GTIN.html#_modBound"><span class="hs-identifier hs-type">_modBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679062387"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062388"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062388"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062387"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062387"><span class="hs-identifier hs-type">i</span></a></span></span></span><span>
</span><span id="line-177"></span><span id="_modBound"><span class="annot"><span class="annottext">_modBound :: forall i (n :: Natural).
(Integral i, KnownNat n) =&gt;
GTIN n -&gt; i -&gt; i
</span><a href="Data.Trade.GTIN.html#_modBound"><span class="hs-identifier hs-var hs-var">_modBound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; i -&gt; i -&gt; i
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod</span></span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; (GTIN n -&gt; i) -&gt; GTIN n -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; i
forall i (n :: Natural). (Integral i, KnownNat n) =&gt; GTIN n -&gt; i
</span><a href="Data.Trade.GTIN.html#_maxBound%27%27"><span class="hs-identifier hs-var">_maxBound''</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span id="local-6989586621679062980"><span class="annot"><a href="Data.Trade.GTIN.html#_checkgtin"><span class="hs-identifier hs-type">_checkgtin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062980"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-180"></span><span id="_checkgtin"><span class="annot"><span class="annottext">_checkgtin :: forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_checkgtin"><span class="hs-identifier hs-var hs-var">_checkgtin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; GTIN n
forall (n :: Natural). GTIN n -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#fixChecksum"><span class="hs-identifier hs-var">fixChecksum</span></a></span><span> </span><span class="annot"><span class="annottext">(GTIN n -&gt; GTIN n) -&gt; (Word64 -&gt; GTIN n) -&gt; Word64 -&gt; GTIN n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span id="local-6989586621679062395"><span class="annot"><a href="Data.Trade.GTIN.html#_checkgtin%27"><span class="hs-identifier hs-type">_checkgtin'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062395"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-183"></span><span id="_checkgtin%27"><span class="annot"><span class="annottext">_checkgtin' :: forall (n :: Natural). [Word64] -&gt; [GTIN n]
</span><a href="Data.Trade.GTIN.html#_checkgtin%27"><span class="hs-identifier hs-var hs-var">_checkgtin'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; GTIN n) -&gt; [Word64] -&gt; [GTIN n]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_checkgtin"><span class="hs-identifier hs-var">_checkgtin</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="annot"><a href="Data.Trade.GTIN.html#_wipe"><span class="hs-identifier hs-type">_wipe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-186"></span><span id="_wipe"><span class="annot"><span class="annottext">_wipe :: Word64 -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_wipe"><span class="hs-identifier hs-var hs-var">_wipe</span></a></span></span><span> </span><span id="local-6989586621679062984"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679062984"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679062984"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679062984"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span id="local-6989586621679062985"><span class="annot"><a href="Data.Trade.GTIN.html#_tocheck"><span class="hs-identifier hs-type">_tocheck</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679062985"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062985"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062985"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062985"><span class="hs-identifier hs-type">i</span></a></span></span><span>
</span><span id="line-189"></span><span id="_tocheck"><span class="annot"><span class="annottext">_tocheck :: forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="Data.Trade.GTIN.html#_tocheck"><span class="hs-identifier hs-var hs-var">_tocheck</span></a></span></span><span> </span><span id="local-6989586621679062999"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062999"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679063000"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679063000"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679063000"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679063002"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679063003"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-number">10</span></span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679063002"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679063002"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679063003"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679063003"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679062999"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; (i, i)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`quotRem`</span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-number">10</span></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="annot"><a href="Data.Trade.GTIN.html#_determineChecksum"><span class="hs-identifier hs-type">_determineChecksum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-194"></span><span id="_determineChecksum"><span class="annot"><span class="annottext">_determineChecksum :: Word64 -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_determineChecksum"><span class="hs-identifier hs-var hs-var">_determineChecksum</span></a></span></span><span> </span><span id="local-6989586621679063013"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063013"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679063014"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063013"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621679063014"><span class="annot"><span class="annottext">go :: b -&gt; b -&gt; b
</span><a href="#local-6989586621679063014"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; b
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><a href="#local-6989586621679063014"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679063030"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679063030"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
</span><a href="#local-6989586621679063014"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679063031"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; (b -&gt; b) -&gt; b -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="Data.Trade.GTIN.html#_tocheck"><span class="hs-identifier hs-var">_tocheck</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679063032"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-198"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679063031"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679063031"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679063032"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679063032"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679063030"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; (b, b)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`quotRem`</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">100</span></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="annot"><span class="hs-comment">-- | Fix the checksum of a given 'GTIN' object. If the checksum is valid, then it will return the same GTIN, this operation is thus /idempotent/.</span></span><span>
</span><span id="line-202"></span><span id="local-6989586621679062356"><span class="annot"><a href="Data.Trade.GTIN.html#fixChecksum"><span class="hs-identifier hs-type">fixChecksum</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The given 'GTIN' number where we fix the checksum from.</span></span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062356"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><span class="hs-comment">-- | A 'GTIN' object that is the variant of the given 'GTIN' number, with a valid checksum.</span></span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062356"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-207"></span><span id="fixChecksum"><span class="annot"><span class="annottext">fixChecksum :: forall (n :: Natural). GTIN n -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#fixChecksum"><span class="hs-identifier hs-var hs-var">fixChecksum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063042"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063042"><span class="hs-identifier hs-var">w'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063042"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063043"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_determineChecksum"><span class="hs-identifier hs-var">_determineChecksum</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063044"><span class="hs-identifier hs-var">w0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679063044"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063044"><span class="hs-identifier hs-var">w0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679063043"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063043"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063042"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; (Word64, Word64)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`quotRem`</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="annot"><span class="hs-comment">-- | Check if the given checksum matches.</span></span><span>
</span><span id="line-212"></span><span id="local-6989586621679062366"><span class="annot"><a href="Data.Trade.GTIN.html#checkChecksum"><span class="hs-identifier hs-type">checkChecksum</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The given 'GTIN' number for which we check the checksum.</span></span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062366"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><span class="hs-comment">-- | 'True' if the given checksum matches; 'False' otherwise.</span></span><span>
</span><span id="line-216"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-217"></span><span id="checkChecksum"><span class="annot"><span class="annottext">checkChecksum :: forall (n :: Natural). GTIN n -&gt; Bool
</span><a href="Data.Trade.GTIN.html#checkChecksum"><span class="hs-identifier hs-var hs-var">checkChecksum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063048"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063048"><span class="hs-identifier hs-var">w'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_determineChecksum"><span class="hs-identifier hs-var">_determineChecksum</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063049"><span class="hs-identifier hs-var">w0</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063050"><span class="hs-identifier hs-var">w1</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679063049"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063049"><span class="hs-identifier hs-var">w0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679063050"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063050"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063048"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; (Word64, Word64)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`quotRem`</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="annot"><span class="hs-comment">-- | Convert one 'GTIN' into a 'GTIN' that has more digits. The new 'GTIN' will have additional leading zeros.</span></span><span>
</span><span id="line-222"></span><span id="local-6989586621679062404"><span id="local-6989586621679062405"><span class="annot"><a href="Data.Trade.GTIN.html#upscaleGTIN"><span class="hs-identifier hs-type">upscaleGTIN</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><a href="#local-6989586621679062404"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062405"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The original 'GTIN' number to upscale.</span></span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062404"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><span class="hs-comment">-- | A 'GTIN' with the same number, but more (or the same) number of digits.</span></span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062405"><span class="hs-identifier hs-type">n</span></a></span></span></span><span>
</span><span id="line-228"></span><span id="upscaleGTIN"><span class="annot"><span class="annottext">upscaleGTIN :: forall (m :: Natural) (n :: Natural). (m &lt;= n) =&gt; GTIN m -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#upscaleGTIN"><span class="hs-identifier hs-var hs-var">upscaleGTIN</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063054"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063054"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063054"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="annot"><span class="hs-comment">-- | Check if two 'GTIN' numbers, possibly with a different &quot;width&quot; are equivalent.</span></span><span>
</span><span id="line-231"></span><span id="local-6989586621679062408"><span id="local-6989586621679062409"><span class="annot"><a href="Data.Trade.GTIN.html#equivGTIN"><span class="hs-identifier hs-type">equivGTIN</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The first 'GTIN' to check.</span></span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062408"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The second 'GTIN' to check.</span></span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062409"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><span class="hs-comment">-- | 'True' if the given 'GTIN' values are equivalent; 'False' otherwise.</span></span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-238"></span><span id="equivGTIN"><span class="annot"><span class="annottext">equivGTIN :: forall (m :: Natural) (n :: Natural). GTIN m -&gt; GTIN n -&gt; Bool
</span><a href="Data.Trade.GTIN.html#equivGTIN"><span class="hs-identifier hs-var hs-var">equivGTIN</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063056"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063056"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063057"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063057"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063056"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063057"><span class="hs-identifier hs-var">w2</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062416"><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062416"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Validity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062416"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621679063067"><span class="annot"><span class="annottext">validate :: GTIN n -&gt; Validation
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></span></span><span> </span><span id="local-6989586621679063068"><span class="annot"><span class="annottext">g :: GTIN n
</span><a href="#local-6989586621679063068"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063069"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063069"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-242"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; [Char] -&gt; Validation
</span><span class="hs-identifier hs-var">check</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063069"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall i (n :: Natural). (Integral i, KnownNat n) =&gt; GTIN n -&gt; i
</span><a href="Data.Trade.GTIN.html#_maxBound"><span class="hs-identifier hs-var">_maxBound</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063068"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The value is larger than the maximum number of digits.&quot;</span></span><span>
</span><span id="line-243"></span><span>      </span><span class="annot"><span class="annottext">Validation -&gt; Validation -&gt; Validation
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Char] -&gt; Validation
</span><span class="hs-identifier hs-var">check</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Bool
forall (n :: Natural). GTIN n -&gt; Bool
</span><a href="Data.Trade.GTIN.html#checkChecksum"><span class="hs-identifier hs-var">checkChecksum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063068"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;checksum does not match: expected &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679063070"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Char
</span><a href="#local-6989586621679063071"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063072"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; [Char] -&gt; [Char]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, but got &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679063070"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Char
</span><a href="#local-6989586621679063071"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063073"><span class="hs-identifier hs-var">w0</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; [Char] -&gt; [Char]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>      </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679063076"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063076"><span class="hs-identifier hs-var">w'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679063073"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063073"><span class="hs-identifier hs-var">w0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063069"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; (Word64, Word64)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`divMod`</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span>
</span><span id="line-246"></span><span>      </span><span id="local-6989586621679063072"><span class="annot"><span class="annottext">c' :: Word64
</span><a href="#local-6989586621679063072"><span class="hs-identifier hs-var hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_determineChecksum"><span class="hs-identifier hs-var">_determineChecksum</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063076"><span class="hs-identifier hs-var">w'</span></a></span><span>
</span><span id="line-247"></span><span>      </span><span id="local-6989586621679063070"><span class="annot"><span class="annottext">pf :: [Char]
</span><a href="#local-6989586621679063070"><span class="hs-identifier hs-var hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word64 -&gt; [Char]
forall i j. (Integral i, Show i, PrintfArg j) =&gt; i -&gt; j -&gt; [Char]
</span><a href="Data.Trade.GTIN.html#_printf"><span class="hs-identifier hs-var">_printf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Int
forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; Int
</span><a href="Data.Trade.GTIN.html#_decw%27"><span class="hs-identifier hs-var">_decw'</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063068"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063076"><span class="hs-identifier hs-var">w'</span></a></span><span>
</span><span id="line-248"></span><span>      </span><span id="local-6989586621679063071"><span class="annot"><span class="annottext">cc :: Word64 -&gt; Char
</span><a href="#local-6989586621679063071"><span class="hs-identifier hs-var hs-var">cc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char
</span><span class="hs-identifier hs-var">chr</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Char) -&gt; (Word64 -&gt; Int) -&gt; Word64 -&gt; Char
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x1d7ce</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; (Word64 -&gt; Int) -&gt; Word64 -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span id="local-6989586621679062420"><span id="local-6989586621679062421"><span class="annot"><a href="Data.Trade.GTIN.html#_printf"><span class="hs-identifier hs-type">_printf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679062420"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679062420"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrintfArg</span></span><span> </span><span class="annot"><a href="#local-6989586621679062421"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062420"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062421"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span><span>
</span><span id="line-251"></span><span id="_printf"><span class="annot"><span class="annottext">_printf :: forall i j. (Integral i, Show i, PrintfArg j) =&gt; i -&gt; j -&gt; [Char]
</span><a href="Data.Trade.GTIN.html#_printf"><span class="hs-identifier hs-var hs-var">_printf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; j -&gt; [Char]
forall r. PrintfType r =&gt; [Char] -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; j -&gt; [Char]) -&gt; (i -&gt; [Char]) -&gt; i -&gt; j -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;%0&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; (i -&gt; [Char]) -&gt; i -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;d&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; (i -&gt; [Char]) -&gt; i -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span id="local-6989586621679062431"><span id="local-6989586621679062432"><span class="annot"><a href="Data.Trade.GTIN.html#_printf%27"><span class="hs-identifier hs-type">_printf'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062431"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrintfArg</span></span><span> </span><span class="annot"><a href="#local-6989586621679062432"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062431"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062432"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span><span>
</span><span id="line-254"></span><span id="_printf%27"><span class="annot"><span class="annottext">_printf' :: forall (n :: Natural) j.
(KnownNat n, PrintfArg j) =&gt;
GTIN n -&gt; j -&gt; [Char]
</span><a href="Data.Trade.GTIN.html#_printf%27"><span class="hs-identifier hs-var hs-var">_printf'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; j -&gt; [Char]
forall i j. (Integral i, Show i, PrintfArg j) =&gt; i -&gt; j -&gt; [Char]
</span><a href="Data.Trade.GTIN.html#_printf"><span class="hs-identifier hs-var">_printf</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; j -&gt; [Char]) -&gt; (GTIN n -&gt; Int) -&gt; GTIN n -&gt; j -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Int
forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; Int
</span><a href="Data.Trade.GTIN.html#_decw"><span class="hs-identifier hs-var">_decw</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062436"><span id="local-6989586621679063116"><span id="local-6989586621679063120"><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062436"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062436"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621679063130"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; GTIN n -&gt; [Char] -&gt; [Char]
</span><a href="#local-6989586621679063130"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679063132"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063132"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679063133"><span class="annot"><span class="annottext">g :: GTIN n
</span><a href="#local-6989586621679063133"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063134"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063134"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ([Char] -&gt; [Char]) -&gt; [Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">showParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063132"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;GTIN &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Word64 -&gt; [Char]
forall r. PrintfType r =&gt; [Char] -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;%0&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679063137"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;d&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063134"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; :: GTIN &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679063137"><span class="hs-identifier hs-var">sn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-259"></span><span>      </span><span id="local-6989586621679063137"><span class="annot"><span class="annottext">sn :: [Char]
</span><a href="#local-6989586621679063137"><span class="hs-identifier hs-var hs-var">sn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Int
forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; Int
</span><a href="Data.Trade.GTIN.html#_decw"><span class="hs-identifier hs-var">_decw</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063133"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="annot"><span class="hs-comment">-- | Convert the given 'GTIN' number to convert to a 'String' that groups numbers into groups of four.</span></span><span>
</span><span id="line-262"></span><span id="local-6989586621679063140"><span class="annot"><a href="Data.Trade.GTIN.html#gtinToString"><span class="hs-identifier hs-type">gtinToString</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679063140"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The given 'GTIN' number to convert to a readable 'String'.</span></span><span>
</span><span id="line-265"></span><span>  </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063140"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-266"></span><span>  </span><span class="annot"><span class="hs-comment">-- | A 'String' that contains the GTIN number, in chucks of four digits.</span></span><span>
</span><span id="line-267"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-268"></span><span id="gtinToString"><span class="annot"><span class="annottext">gtinToString :: forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; [Char]
</span><a href="Data.Trade.GTIN.html#gtinToString"><span class="hs-identifier hs-var hs-var">gtinToString</span></a></span></span><span> </span><span id="local-6989586621679063147"><span class="annot"><span class="annottext">g :: GTIN n
</span><a href="#local-6989586621679063147"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063148"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063148"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, Word64) -&gt; [Char]) -&gt; [(Int, Word64)] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Int, Word64) -&gt; [Char]
forall {t} {t} {a}.
(PrintfArg t, PrintfType t, Show a) =&gt;
(a, t) -&gt; t
</span><a href="#local-6989586621679063150"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Int, Word64)] -&gt; [(Int, Word64)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, Word64) -&gt; Maybe ((Int, Word64), (Int, Word64)))
-&gt; (Int, Word64) -&gt; [(Int, Word64)]
forall b a. (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]
</span><span class="hs-identifier hs-var">unfoldr</span></span><span> </span><span class="annot"><span class="annottext">(Int, Word64) -&gt; Maybe ((Int, Word64), (Int, Word64))
forall {b}. Integral b =&gt; (Int, b) -&gt; Maybe ((Int, b), (Int, b))
</span><a href="#local-6989586621679063152"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063153"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063148"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621679063153"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679063153"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Int
forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; Int
</span><a href="Data.Trade.GTIN.html#_decw"><span class="hs-identifier hs-var">_decw</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063147"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621679063157"><span class="annot"><span class="annottext">ww' :: Int
</span><a href="#local-6989586621679063157"><span class="hs-identifier hs-var hs-var">ww'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063153"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679063161"><span class="annot"><span class="annottext">ww :: Int
</span><a href="#local-6989586621679063161"><span class="hs-identifier hs-var hs-var">ww</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063157"><span class="hs-identifier hs-var">ww'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063157"><span class="hs-identifier hs-var">ww'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621679063150"><span class="annot"><span class="annottext">p :: (a, t) -&gt; t
</span><a href="#local-6989586621679063150"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063167"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063167"><span class="hs-identifier hs-var">n0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679063168"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679063168"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; t -&gt; t
forall r. PrintfType r =&gt; [Char] -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;%0&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063167"><span class="hs-identifier hs-var">n0</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;d&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679063168"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621679063152"><span class="annot"><span class="annottext">f :: (Int, b) -&gt; Maybe ((Int, b), (Int, b))
</span><a href="#local-6989586621679063152"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063178"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063178"><span class="hs-identifier hs-var">n0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679063179"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679063179"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063178"><span class="hs-identifier hs-var">n0</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ((Int, b), (Int, b))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-276"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, b), (Int, b)) -&gt; Maybe ((Int, b), (Int, b))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063180"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679063181"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063178"><span class="hs-identifier hs-var">n0</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063180"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679063182"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-278"></span><span>        </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679063182"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679063182"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679063181"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679063181"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679063179"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; (b, b)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`quotRem`</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">10000</span></span><span>
</span><span id="line-279"></span><span>        </span><span id="local-6989586621679063180"><span class="annot"><span class="annottext">dd :: Int
</span><a href="#local-6989586621679063180"><span class="hs-identifier hs-var hs-var">dd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063161"><span class="hs-identifier hs-var">ww</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063178"><span class="hs-identifier hs-var">n0</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062446"><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><a href="#local-6989586621679062446"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062446"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062446"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-282"></span><span>  </span><span id="local-6989586621679063206"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063206"><span class="hs-identifier hs-var">g1</span></a></span></span><span> </span><span id="local-6989586621679063207"><span class="annot"><span class="annottext">+ :: GTIN n -&gt; GTIN n -&gt; GTIN n
</span><span class="hs-operator hs-var hs-var hs-var hs-var">+</span></span></span><span> </span><span id="local-6989586621679063208"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063208"><span class="hs-identifier hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var">_toEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Word64 -&gt; Word64
forall i (n :: Natural).
(Integral i, KnownNat n) =&gt;
GTIN n -&gt; i -&gt; i
</span><a href="Data.Trade.GTIN.html#_modBound"><span class="hs-identifier hs-var">_modBound</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063206"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063206"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063208"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- can handle overflow, since we first omit the checksum</span><span>
</span><span id="line-283"></span><span>  </span><span id="local-6989586621679063215"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063215"><span class="hs-identifier hs-var">g1</span></a></span></span><span> </span><span id="local-6989586621679063216"><span class="annot"><span class="annottext">- :: GTIN n -&gt; GTIN n -&gt; GTIN n
</span><span class="hs-glyph hs-var hs-var hs-var hs-var">-</span></span></span><span> </span><span id="local-6989586621679063217"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063217"><span class="hs-identifier hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var">_toEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Word64 -&gt; Word64
forall i (n :: Natural).
(Integral i, KnownNat n) =&gt;
GTIN n -&gt; i -&gt; i
</span><a href="Data.Trade.GTIN.html#_modBound"><span class="hs-identifier hs-var">_modBound</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063215"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall i (n :: Natural). (Integral i, KnownNat n) =&gt; GTIN n -&gt; i
</span><a href="Data.Trade.GTIN.html#_maxBound%27%27"><span class="hs-identifier hs-var">_maxBound''</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063215"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063215"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063217"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621679063222"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063222"><span class="hs-identifier hs-var">g1</span></a></span></span><span> </span><span id="local-6989586621679063223"><span class="annot"><span class="annottext">* :: GTIN n -&gt; GTIN n -&gt; GTIN n
</span><span class="hs-operator hs-var hs-var hs-var hs-var">*</span></span></span><span> </span><span id="local-6989586621679063224"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063224"><span class="hs-identifier hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var">_toEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word64
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Integer -&gt; Integer
forall i (n :: Natural).
(Integral i, KnownNat n) =&gt;
GTIN n -&gt; i -&gt; i
</span><a href="Data.Trade.GTIN.html#_modBound"><span class="hs-identifier hs-var">_modBound</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063222"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Integer
forall {n :: Natural}. GTIN n -&gt; Integer
</span><a href="#local-6989586621679063225"><span class="hs-identifier hs-var">fe</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063222"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Integer
forall {n :: Natural}. GTIN n -&gt; Integer
</span><a href="#local-6989586621679063225"><span class="hs-identifier hs-var">fe</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063224"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-286"></span><span>      </span><span id="local-6989586621679063225"><span class="annot"><span class="annottext">fe :: GTIN n -&gt; Integer
</span><a href="#local-6989586621679063225"><span class="hs-identifier hs-var hs-var">fe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Integer) -&gt; (GTIN n -&gt; Word64) -&gt; GTIN n -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span>
</span><span id="line-287"></span><span>  </span><span id="local-6989586621679063233"><span class="annot"><span class="annottext">negate :: GTIN n -&gt; GTIN n
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">negate</span></span></span><span> </span><span id="local-6989586621679063234"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063234"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var">_toEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Word64 -&gt; Word64
forall i (n :: Natural).
(Integral i, KnownNat n) =&gt;
GTIN n -&gt; i -&gt; i
</span><a href="Data.Trade.GTIN.html#_modBound"><span class="hs-identifier hs-var">_modBound</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063234"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall i (n :: Natural). (Integral i, KnownNat n) =&gt; GTIN n -&gt; i
</span><a href="Data.Trade.GTIN.html#_maxBound%27%27"><span class="hs-identifier hs-var">_maxBound''</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063234"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063234"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621679063235"><span class="annot"><span class="annottext">abs :: GTIN n -&gt; GTIN n
</span><a href="#local-6989586621679063235"><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; GTIN n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-289"></span><span>  </span><span id="local-6989586621679063238"><span class="annot"><span class="annottext">signum :: GTIN n -&gt; GTIN n
</span><a href="#local-6989586621679063238"><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var">_toEnum</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; GTIN n) -&gt; (GTIN n -&gt; Word64) -&gt; GTIN n -&gt; GTIN n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Word64) -&gt; (GTIN n -&gt; Word64) -&gt; GTIN n -&gt; Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621679063240"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; GTIN n
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></span></span><span> </span><span id="local-6989586621679063241"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679063241"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063242"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-292"></span><span>      </span><span id="local-6989586621679063242"><span class="annot"><span class="annottext">v :: GTIN n
</span><a href="#local-6989586621679063242"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var">_toEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word64
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Integer -&gt; Integer
forall i (n :: Natural).
(Integral i, KnownNat n) =&gt;
GTIN n -&gt; i -&gt; i
</span><a href="Data.Trade.GTIN.html#_modBound"><span class="hs-identifier hs-var">_modBound</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063242"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679063241"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062451"><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><a href="#local-6989586621679062451"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062451"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062451"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-295"></span><span>  </span><span id="local-6989586621679063259"><span class="annot"><span class="annottext">toRational :: GTIN n -&gt; Rational
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toRational</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Rational) -&gt; (GTIN n -&gt; Word64) -&gt; GTIN n -&gt; Rational
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062454"><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><a href="#local-6989586621679062454"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062454"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062454"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-298"></span><span>  </span><span id="local-6989586621679063280"><span class="annot"><span class="annottext">toInteger :: GTIN n -&gt; Integer
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toInteger</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Integer) -&gt; (GTIN n -&gt; Word64) -&gt; GTIN n -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span id="local-6989586621679063281"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063281"><span class="hs-identifier hs-var">g1</span></a></span></span><span> </span><span id="local-6989586621679063282"><span class="annot"><span class="annottext">quotRem :: GTIN n -&gt; GTIN n -&gt; (GTIN n, GTIN n)
</span><span class="hs-operator hs-var hs-var hs-var hs-var">`quotRem`</span></span></span><span> </span><span id="local-6989586621679063283"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063283"><span class="hs-identifier hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var">_toEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063284"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var">_toEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063285"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679063284"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063284"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679063285"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063285"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063281"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; (Word64, Word64)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`quotRem`</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063283"><span class="hs-identifier hs-var">g2</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span id="local-6989586621679063287"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063287"><span class="hs-identifier hs-var">g1</span></a></span></span><span> </span><span id="local-6989586621679063288"><span class="annot"><span class="annottext">divMod :: GTIN n -&gt; GTIN n -&gt; (GTIN n, GTIN n)
</span><span class="hs-operator hs-var hs-var hs-var hs-var">`divMod`</span></span></span><span> </span><span id="local-6989586621679063289"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063289"><span class="hs-identifier hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var">_toEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063290"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var">_toEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063291"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-304"></span><span>      </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679063290"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063290"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679063291"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063291"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063287"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; (Word64, Word64)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`divMod`</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063289"><span class="hs-identifier hs-var">g2</span></a></span><span>
</span><span id="line-305"></span><span>  </span><span id="local-6989586621679063294"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063294"><span class="hs-identifier hs-var">g1</span></a></span></span><span> </span><span id="local-6989586621679063295"><span class="annot"><span class="annottext">quot :: GTIN n -&gt; GTIN n -&gt; GTIN n
</span><a href="#local-6989586621679063295"><span class="hs-operator hs-var hs-var hs-var hs-var">`quot`</span></a></span></span><span> </span><span id="local-6989586621679063297"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063297"><span class="hs-identifier hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var">_toEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063294"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063297"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>  </span><span id="local-6989586621679063299"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063299"><span class="hs-identifier hs-var">g1</span></a></span></span><span> </span><span id="local-6989586621679063300"><span class="annot"><span class="annottext">rem :: GTIN n -&gt; GTIN n -&gt; GTIN n
</span><a href="#local-6989586621679063300"><span class="hs-operator hs-var hs-var hs-var hs-var">`rem`</span></a></span></span><span> </span><span id="local-6989586621679063302"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063302"><span class="hs-identifier hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var">_toEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063299"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`rem`</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063302"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>  </span><span id="local-6989586621679063304"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063304"><span class="hs-identifier hs-var">g1</span></a></span></span><span> </span><span id="local-6989586621679063305"><span class="annot"><span class="annottext">div :: GTIN n -&gt; GTIN n -&gt; GTIN n
</span><span class="hs-operator hs-var hs-var hs-var hs-var">`div`</span></span></span><span> </span><span id="local-6989586621679063306"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063306"><span class="hs-identifier hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var">_toEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063304"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063306"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621679063308"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063308"><span class="hs-identifier hs-var">g1</span></a></span></span><span> </span><span id="local-6989586621679063309"><span class="annot"><span class="annottext">mod :: GTIN n -&gt; GTIN n -&gt; GTIN n
</span><span class="hs-operator hs-var hs-var hs-var hs-var">`mod`</span></span></span><span> </span><span id="local-6989586621679063310"><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063310"><span class="hs-identifier hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var">_toEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063308"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall (n :: Natural). GTIN n -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_fromEnum"><span class="hs-identifier hs-var">_fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063310"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062459"><span id="local-6989586621679063315"><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><a href="#local-6989586621679062459"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062459"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062459"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span>  </span><span id="local-6989586621679063331"><span class="annot"><span class="annottext">arbitrary :: Gen (GTIN n)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">arbitrary</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#_toEnum"><span class="hs-identifier hs-var">_toEnum</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; GTIN n) -&gt; Gen Word64 -&gt; Gen (GTIN n)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Gen Word64
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><span class="hs-identifier hs-var">choose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall i (n :: Natural). (Integral i, KnownNat n) =&gt; GTIN n -&gt; i
</span><a href="Data.Trade.GTIN.html#_maxBound%27%27"><span class="hs-identifier hs-var">_maxBound''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n
forall (n :: Natural). GTIN n
</span><a href="Data.Trade.GTIN.html#_hole"><span class="hs-identifier hs-var">_hole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062459"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062478"><span id="local-6989586621679063336"><span id="local-6989586621679063343"><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062478"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062484"><span id="local-6989586621679063356"><span class="annot"><span class="hs-identifier hs-type">Binary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062484"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>  </span><span id="local-6989586621679063364"><span class="annot"><span class="annottext">get :: Get (GTIN n)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; GTIN n) -&gt; Get Word64 -&gt; Get (GTIN n)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Word64
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-317"></span><span>  </span><span id="local-6989586621679063366"><span class="annot"><span class="annottext">put :: GTIN n -&gt; Put
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">put</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063367"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063367"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063367"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-cpp">

#if MIN_VERSION_base(4,16,4)
</span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062487"><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062487"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bounded</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062487"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-321"></span><span>  </span><span id="local-6989586621679063374"><span class="annot"><span class="annottext">minBound :: GTIN n
</span><a href="#local-6989586621679063374"><span class="hs-identifier hs-var hs-var hs-var hs-var">minBound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; GTIN n
forall (n :: Natural). GTIN n -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#fixChecksum"><span class="hs-identifier hs-var">fixChecksum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>  </span><span id="local-6989586621679063382"><span class="annot"><span class="annottext">maxBound :: GTIN n
</span><a href="#local-6989586621679063382"><span class="hs-identifier hs-var hs-var hs-var hs-var">maxBound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; GTIN n
forall (n :: Natural). GTIN n -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#fixChecksum"><span class="hs-identifier hs-var">fixChecksum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Int
forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; Int
</span><a href="Data.Trade.GTIN.html#_decw"><span class="hs-identifier hs-var">_decw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n
forall (n :: Natural). GTIN n
</span><a href="Data.Trade.GTIN.html#_hole"><span class="hs-identifier hs-var">_hole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062487"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">KnownNat</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Bounded</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Nat</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-identifier">minBound</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fixChecksum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-identifier">maxBound</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fixChecksum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-special">(</span><span class="hs-number">10</span><span> </span><span class="hs-operator">^</span><span> </span><span class="hs-identifier">_decw</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_hole</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_base(4,16,4)
</span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062453"><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062453"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679062453"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-331"></span><span>  </span><span id="local-6989586621679063396"><span class="annot"><span class="annottext">succ :: GTIN n -&gt; GTIN n
</span><a href="#local-6989586621679063396"><span class="hs-identifier hs-var hs-var hs-var hs-var">succ</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063398"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063398"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; GTIN n
forall (n :: Natural). GTIN n -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#fixChecksum"><span class="hs-identifier hs-var">fixChecksum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063398"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>  </span><span id="local-6989586621679063401"><span class="annot"><span class="annottext">pred :: GTIN n -&gt; GTIN n
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pred</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063402"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063402"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; GTIN n
forall (n :: Natural). GTIN n -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#fixChecksum"><span class="hs-identifier hs-var">fixChecksum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063402"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>  </span><span id="local-6989586621679063404"><span class="annot"><span class="annottext">toEnum :: Int -&gt; GTIN n
</span><a href="#local-6989586621679063404"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEnum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; GTIN n) -&gt; (Int -&gt; Word64) -&gt; Int -&gt; GTIN n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span>
</span><span id="line-334"></span><span>  </span><span id="local-6989586621679063407"><span class="annot"><span class="annottext">fromEnum :: GTIN n -&gt; Int
</span><a href="#local-6989586621679063407"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromEnum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063409"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063409"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063409"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-335"></span><span>  </span><span id="local-6989586621679063415"><span class="annot"><span class="annottext">enumFrom :: GTIN n -&gt; [GTIN n]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">enumFrom</span></span></span><span> </span><span id="local-6989586621679063416"><span class="annot"><span class="annottext">g :: GTIN n
</span><a href="#local-6989586621679063416"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063417"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063417"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word64] -&gt; [GTIN n]
forall (n :: Natural). [Word64] -&gt; [GTIN n]
</span><a href="Data.Trade.GTIN.html#_checkgtin%27"><span class="hs-identifier hs-var">_checkgtin'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063417"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063417"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall i (n :: Natural). (Integral i, KnownNat n) =&gt; GTIN n -&gt; i
</span><a href="Data.Trade.GTIN.html#_maxBound"><span class="hs-identifier hs-var">_maxBound</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063416"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-336"></span><span>  </span><span id="local-6989586621679063424"><span class="annot"><span class="annottext">enumFromThen :: GTIN n -&gt; GTIN n -&gt; [GTIN n]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">enumFromThen</span></span></span><span> </span><span id="local-6989586621679063425"><span class="annot"><span class="annottext">g :: GTIN n
</span><a href="#local-6989586621679063425"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063426"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063426"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063427"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063427"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063426"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063427"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word64] -&gt; [GTIN n]
forall (n :: Natural). [Word64] -&gt; [GTIN n]
</span><a href="Data.Trade.GTIN.html#_checkgtin%27"><span class="hs-identifier hs-var">_checkgtin'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_wipe"><span class="hs-identifier hs-var">_wipe</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063426"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_wipe"><span class="hs-identifier hs-var">_wipe</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063427"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Word64
forall i (n :: Natural). (Integral i, KnownNat n) =&gt; GTIN n -&gt; i
</span><a href="Data.Trade.GTIN.html#_maxBound"><span class="hs-identifier hs-var">_maxBound</span></a></span><span> </span><span class="annot"><span class="annottext">GTIN n
</span><a href="#local-6989586621679063425"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word64] -&gt; [GTIN n]
forall (n :: Natural). [Word64] -&gt; [GTIN n]
</span><a href="Data.Trade.GTIN.html#_checkgtin%27"><span class="hs-identifier hs-var">_checkgtin'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_wipe"><span class="hs-identifier hs-var">_wipe</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063426"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_wipe"><span class="hs-identifier hs-var">_wipe</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063427"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-339"></span><span>  </span><span id="local-6989586621679063429"><span class="annot"><span class="annottext">enumFromThenTo :: GTIN n -&gt; GTIN n -&gt; GTIN n -&gt; [GTIN n]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">enumFromThenTo</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063430"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063430"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063431"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063431"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063432"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063432"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word64] -&gt; [GTIN n]
forall (n :: Natural). [Word64] -&gt; [GTIN n]
</span><a href="Data.Trade.GTIN.html#_checkgtin%27"><span class="hs-identifier hs-var">_checkgtin'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_wipe"><span class="hs-identifier hs-var">_wipe</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063430"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_wipe"><span class="hs-identifier hs-var">_wipe</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063431"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.Trade.GTIN.html#_wipe"><span class="hs-identifier hs-var">_wipe</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063432"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-340"></span><span>  </span><span id="local-6989586621679063436"><span class="annot"><span class="annottext">enumFromTo :: GTIN n -&gt; GTIN n -&gt; [GTIN n]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">enumFromTo</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063437"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063437"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063438"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063438"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; GTIN n) -&gt; [Word64] -&gt; [GTIN n]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; GTIN n
forall (n :: Natural). GTIN n -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#fixChecksum"><span class="hs-identifier hs-var">fixChecksum</span></a></span><span> </span><span class="annot"><span class="annottext">(GTIN n -&gt; GTIN n) -&gt; (Word64 -&gt; GTIN n) -&gt; Word64 -&gt; GTIN n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063437"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063437"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063438"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">KnownNat</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Enum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Nat</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-identifier">succ</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fixChecksum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">w</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>  </span><span class="hs-identifier">pred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fixChecksum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">w</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-identifier">toEnum</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">toEnum</span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-identifier">fromEnum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromEnum</span><span> </span><span class="hs-identifier">w</span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-identifier">enumFrom</span><span> </span><span class="hs-identifier">g</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_checkgtin'</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-identifier">_maxBound</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">]</span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-identifier">enumFromThen</span><span> </span><span class="hs-identifier">g</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_checkgtin'</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_wipe</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_wipe</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-identifier">_maxBound</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">]</span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_checkgtin'</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_wipe</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_wipe</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">0</span><span class="hs-special">]</span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-identifier">enumFromThenTo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">o</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_checkgtin'</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_wipe</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_wipe</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-identifier">_wipe</span><span> </span><span class="hs-identifier">o</span><span class="hs-special">]</span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-identifier">enumFromTo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fixChecksum</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">GTIN</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">m</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-355"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679062494"><span class="annot"><span class="hs-identifier hs-type">Lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062494"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-356"></span><span>  </span><span id="local-6989586621679063451"><span class="annot"><span class="annottext">lift :: forall (m :: * -&gt; *). Quote m =&gt; GTIN n -&gt; m Exp
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">lift</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063452"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063452"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; m Exp
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">ConE</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">GTIN</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-operator hs-var">`AppE`</span></span><span> </span><span class="annot"><span class="annottext">Lit -&gt; Exp
</span><span class="hs-identifier hs-var">LitE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Lit
</span><span class="hs-identifier hs-var">IntegerL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063452"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">

#if MIN_VERSION_template_haskell(2, 17, 0)
</span><span>  </span><span id="local-6989586621679063459"><span class="annot"><span class="annottext">liftTyped :: forall (m :: * -&gt; *). Quote m =&gt; GTIN n -&gt; Code m (GTIN n)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">liftTyped</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063460"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063460"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (TExp (GTIN n)) -&gt; Code m (GTIN n)
forall (m :: * -&gt; *) a. m (TExp a) -&gt; Code m a
</span><span class="hs-identifier hs-var">Code</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TExp (GTIN n) -&gt; m (TExp (GTIN n))
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; TExp (GTIN n)
forall a. Exp -&gt; TExp a
</span><span class="hs-identifier hs-var">TExp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">ConE</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">GTIN</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-operator hs-var">`AppE`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lit -&gt; Exp
</span><span class="hs-identifier hs-var">LitE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Lit
</span><span class="hs-identifier hs-var">IntegerL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063460"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#elif MIN_VERSION_template_haskell(2, 16, 0)
</span><span>  </span><span class="hs-identifier">liftTyped</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">TExp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ConE</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">AppE</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LitE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IntegerL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-364"></span><span class="annot"><span class="hs-comment">-- | A type alias for a 'GTIN' number with fourteen numbers, with as range @00 0000 0000 0000@&#8211;@99 9999 9999 9997@.</span></span><span>
</span><span id="line-365"></span><span class="hs-keyword">type</span><span> </span><span id="GTIN14"><span class="annot"><a href="Data.Trade.GTIN.html#GTIN14"><span class="hs-identifier hs-var">GTIN14</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><span class="hs-number">14</span></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="annot"><span class="hs-comment">-- | A type alias for a 'GTIN' number with thirteen numbers, with as range @0 0000 0000 0000@&#8211;@9 9999 9999 9994@.</span></span><span>
</span><span id="line-368"></span><span class="hs-keyword">type</span><span> </span><span id="GTIN13"><span class="annot"><a href="Data.Trade.GTIN.html#GTIN13"><span class="hs-identifier hs-var">GTIN13</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><span class="hs-number">13</span></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="annot"><span class="hs-comment">-- | A type alias for a 'GTIN' number with twelve numbers, with as range @0000 0000 0000@&#8211;@9999 9999 9993@.</span></span><span>
</span><span id="line-371"></span><span class="hs-keyword">type</span><span> </span><span id="GTIN12"><span class="annot"><a href="Data.Trade.GTIN.html#GTIN12"><span class="hs-identifier hs-var">GTIN12</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><span class="hs-number">12</span></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="annot"><span class="hs-comment">-- | A type alias for a 'GTIN' number with eight numbers, with as range @0000 0000@&#8211;@9999 9995@.</span></span><span>
</span><span id="line-374"></span><span class="hs-keyword">type</span><span> </span><span id="GTIN8"><span class="annot"><a href="Data.Trade.GTIN.html#GTIN8"><span class="hs-identifier hs-var">GTIN8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="annot"><span class="hs-comment">-- | A type alias for a 'GTIN' number with seventeen numbers, with as range @0 0000 0000 0000 0000@&#8211;@9 9999 9999 9999 9992@.</span></span><span>
</span><span id="line-377"></span><span class="hs-keyword">type</span><span> </span><span id="GSIN"><span class="annot"><a href="Data.Trade.GTIN.html#GSIN"><span class="hs-identifier hs-var">GSIN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><span class="hs-number">17</span></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="annot"><span class="hs-comment">-- | A type alias for a 'GTIN' number with eighteen numbers, with as range @00 0000 0000 0000 0000@&#8211;@99 9999 9999 9999 9995@.</span></span><span>
</span><span id="line-380"></span><span class="hs-keyword">type</span><span> </span><span id="SSCC"><span class="annot"><a href="Data.Trade.GTIN.html#SSCC"><span class="hs-identifier hs-var">SSCC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><span class="hs-number">18</span></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="annot"><span class="hs-comment">-- | A type alias for a 'GTIN' number with fourteen numbers, with as range @00 0000 0000 0000@&#8211;@99 9999 9999 9997@.</span></span><span>
</span><span id="line-383"></span><span class="hs-keyword">type</span><span> </span><span id="EANUCC14"><span class="annot"><a href="Data.Trade.GTIN.html#EANUCC14"><span class="hs-identifier hs-var">EANUCC14</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN14"><span class="hs-identifier hs-type">GTIN14</span></a></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="annot"><span class="hs-comment">-- | A type alias for a 'GTIN' number with fourteen numbers, with as range @00 0000 0000 0000@&#8211;@99 9999 9999 9997@.</span></span><span>
</span><span id="line-386"></span><span class="hs-keyword">type</span><span> </span><span id="SCC14"><span class="annot"><a href="Data.Trade.GTIN.html#SCC14"><span class="hs-identifier hs-var">SCC14</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN14"><span class="hs-identifier hs-type">GTIN14</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="annot"><span class="hs-comment">-- | A type alias for a 'GTIN' number with thirteen numbers, with as range @0 0000 0000 0000@&#8211;@9 9999 9999 9994@.</span></span><span>
</span><span id="line-389"></span><span class="hs-keyword">type</span><span> </span><span id="EAN"><span class="annot"><a href="Data.Trade.GTIN.html#EAN"><span class="hs-identifier hs-var">EAN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN13"><span class="hs-identifier hs-type">GTIN13</span></a></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="annot"><span class="hs-comment">-- | A type alias for a 'GTIN' number with thirteen numbers, with as range @0 0000 0000 0000@&#8211;@9 9999 9999 9994@.</span></span><span>
</span><span id="line-392"></span><span class="hs-keyword">type</span><span> </span><span id="EANUCC13"><span class="annot"><a href="Data.Trade.GTIN.html#EANUCC13"><span class="hs-identifier hs-var">EANUCC13</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN13"><span class="hs-identifier hs-type">GTIN13</span></a></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="annot"><span class="hs-comment">-- | A type alias for a 'GTIN' with thirtheen numbers which is also an ISBN number, with as range @0 0000 0000 0000@&#8211;@9 9999 9999 9994@.</span></span><span>
</span><span id="line-395"></span><span class="hs-keyword">type</span><span> </span><span id="ISBN"><span class="annot"><a href="Data.Trade.GTIN.html#ISBN"><span class="hs-identifier hs-var">ISBN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN13"><span class="hs-identifier hs-type">GTIN13</span></a></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="annot"><span class="hs-comment">-- | A type alias for a 'GTIN' with thirtheen numbers which is also an ISBN number, with as range @0 0000 0000 0000@&#8211;@9 9999 9999 9994@.</span></span><span>
</span><span id="line-398"></span><span class="hs-keyword">type</span><span> </span><span id="ISBN13"><span class="annot"><a href="Data.Trade.GTIN.html#ISBN13"><span class="hs-identifier hs-var">ISBN13</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN13"><span class="hs-identifier hs-type">GTIN13</span></a></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span class="annot"><span class="hs-comment">-- | A type alias for a 'GTIN' number with eight numbers, with as range @0000 0000@&#8211;@9999 9995@.</span></span><span>
</span><span id="line-401"></span><span class="hs-keyword">type</span><span> </span><span id="EANUCC8"><span class="annot"><a href="Data.Trade.GTIN.html#EANUCC8"><span class="hs-identifier hs-var">EANUCC8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN8"><span class="hs-identifier hs-type">GTIN8</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-comment">-- | Convert a given integral number that contains an ISBN-10 number into the 'ISBN13' equivalent. For example @8175257660@ is converted to @9 7881 7525 7665@. This will add a @978@ prefix,</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- and recalculate the checksum.</span><span>
</span><span id="line-405"></span><span id="local-6989586621679062508"><span class="annot"><a href="Data.Trade.GTIN.html#fromISBN10%27"><span class="hs-identifier hs-type">fromISBN10'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-406"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679062508"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-407"></span><span>  </span><span class="annot"><span class="hs-comment">-- | An 'Integral' number that contains an ISBN-10.</span></span><span>
</span><span id="line-408"></span><span>  </span><span class="annot"><a href="#local-6989586621679062508"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-409"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The equivalent ISBN-13 number, which is a 'GTIN' number with the corresponding checksum algorithm.</span></span><span>
</span><span id="line-410"></span><span>  </span><span class="annot"><a href="Data.Trade.GTIN.html#ISBN13"><span class="hs-identifier hs-type">ISBN13</span></a></span></span><span>
</span><span id="line-411"></span><span id="fromISBN10%27"><span class="annot"><span class="annottext">fromISBN10' :: forall i. Integral i =&gt; i -&gt; ISBN13
</span><a href="Data.Trade.GTIN.html#fromISBN10%27"><span class="hs-identifier hs-var hs-var">fromISBN10'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ISBN13 -&gt; ISBN13
forall (n :: Natural). GTIN n -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#fixChecksum"><span class="hs-identifier hs-var">fixChecksum</span></a></span><span> </span><span class="annot"><span class="annottext">(ISBN13 -&gt; ISBN13) -&gt; (i -&gt; ISBN13) -&gt; i -&gt; ISBN13
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; ISBN13
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; ISBN13) -&gt; (i -&gt; Word64) -&gt; i -&gt; ISBN13
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">9780000000000</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Word64) -&gt; (i -&gt; Word64) -&gt; i -&gt; Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span class="hs-cpp">

#if !MIN_VERSION_validity(0,9,0)
</span><span class="hs-identifier">prettyValidate</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Validity</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Either</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-415"></span><span class="hs-identifier">prettyValidate</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">validate</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Validation</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Right</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-417"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Left</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_template_haskell(2, 18, 0)
</span><span id="local-6989586621679062511"><span class="annot"><a href="Data.Trade.GTIN.html#_toPattern"><span class="hs-identifier hs-type">_toPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062511"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span></span><span>
</span><span id="line-422"></span><span id="_toPattern"><span class="annot"><span class="annottext">_toPattern :: forall (n :: Natural). GTIN n -&gt; Pat
</span><a href="Data.Trade.GTIN.html#_toPattern"><span class="hs-identifier hs-var hs-var">_toPattern</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span id="local-6989586621679063469"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063469"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; [Pat] -&gt; Pat
</span><span class="hs-identifier hs-var">ConP</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Lit -&gt; Pat
</span><span class="hs-identifier hs-var">LitP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Lit
</span><span class="hs-identifier hs-var">IntegerL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063469"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">_toPattern</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Pat</span><span>
</span><span id="line-425"></span><span class="hs-identifier">_toPattern</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ConP</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">GTIN</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LitP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IntegerL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-428"></span><span id="local-6989586621679062513"><span id="local-6989586621679062514"><span id="local-6989586621679062515"><span class="annot"><a href="Data.Trade.GTIN.html#_liftEither"><span class="hs-identifier hs-type">_liftEither</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679062513"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679062514"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679062513"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062515"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679062514"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062515"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-429"></span><span id="_liftEither"><span class="annot"><span class="annottext">_liftEither :: forall s (m :: * -&gt; *) a.
(Show s, MonadFail m) =&gt;
Either s a -&gt; m a
</span><a href="Data.Trade.GTIN.html#_liftEither"><span class="hs-identifier hs-var hs-var">_liftEither</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; m a) -&gt; (a -&gt; m a) -&gt; Either s a -&gt; m a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; m a
forall a. [Char] -&gt; m a
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; m a) -&gt; (s -&gt; [Char]) -&gt; s -&gt; m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="hs-comment">-- | A parser for a gtin number with an arbitrary number of digits between two and nineteen. the parser does not /end/ after the gtin (so no 'eof' is required),</span><span>
</span><span id="line-432"></span><span class="hs-comment">-- and furthermore does /not/ validate if the gtin is indeed valid. The parser parses the number of digits with an arbitrary number of spaces between any two digits.</span><span>
</span><span id="line-433"></span><span class="annot"><a href="Data.Trade.GTIN.html#gtinParser_%27"><span class="hs-identifier hs-type">gtinParser_'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-434"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679062525"><span class="annot"><a href="#local-6989586621679062525"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679062528"><span class="annot"><a href="#local-6989586621679062528"><span class="hs-identifier hs-type">u</span></a></span></span><span> </span><span id="local-6989586621679062526"><span class="annot"><a href="#local-6989586621679062526"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679062524"><span class="annot"><a href="#local-6989586621679062524"><span class="hs-identifier hs-type">n</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679062524"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><a href="#local-6989586621679062524"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062524"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stream</span></span><span> </span><span class="annot"><a href="#local-6989586621679062525"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062526"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-436"></span><span>  </span><span class="annot"><span class="hs-comment">-- | A parser parsing a GTIN with an arbitrary number of digits that does /not/ force the stream to end, and does /not/ check the checksum.</span></span><span>
</span><span id="line-437"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ParsecT</span></span><span> </span><span class="annot"><a href="#local-6989586621679062525"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062528"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062526"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062524"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span id="gtinParser_%27"><span class="annot"><span class="annottext">gtinParser_' :: forall s u (m :: * -&gt; *) (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s m Char) =&gt;
ParsecT s u m (GTIN n)
</span><a href="Data.Trade.GTIN.html#gtinParser_%27"><span class="hs-identifier hs-var hs-var">gtinParser_'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GTIN n
forall (n :: Natural). Word64 -&gt; GTIN n
</span><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-var">GTIN</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; GTIN n)
-&gt; ParsecT s u m Word64 -&gt; ParsecT s u m (GTIN n)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT s u m Word64
forall {u}. ParsecT s u m Word64
</span><a href="#local-6989586621679063497"><span class="hs-identifier hs-var">dd</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT s u m Word64
-&gt; (Word64 -&gt; ParsecT s u m Word64) -&gt; ParsecT s u m Word64
forall a b.
ParsecT s u m a -&gt; (a -&gt; ParsecT s u m b) -&gt; ParsecT s u m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word64 -&gt; ParsecT s u m Word64
forall {t} {u}.
(Eq t, Num t) =&gt;
t -&gt; Word64 -&gt; ParsecT s u m Word64
</span><a href="#local-6989586621679063498"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n -&gt; Int
forall (n :: Natural). KnownNat n =&gt; GTIN n -&gt; Int
</span><a href="Data.Trade.GTIN.html#_decw%27"><span class="hs-identifier hs-var">_decw'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GTIN n
forall (n :: Natural). GTIN n
</span><a href="Data.Trade.GTIN.html#_hole"><span class="hs-identifier hs-var">_hole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062524"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-440"></span><span>    </span><span id="local-6989586621679063498"><span class="annot"><span class="annottext">go :: t -&gt; Word64 -&gt; ParsecT s u m Word64
</span><a href="#local-6989586621679063498"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679063516"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063516"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; ParsecT s u m Word64
forall a. a -&gt; ParsecT s u m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063516"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-441"></span><span>    </span><span class="annot"><a href="#local-6989586621679063498"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679063517"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679063517"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679063518"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063518"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT s u m Char -&gt; ParsecT s u m ()
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">skipMany</span></span><span> </span><span class="annot"><span class="annottext">ParsecT s u m Char
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">space</span></span><span> </span><span class="annot"><span class="annottext">ParsecT s u m () -&gt; ParsecT s u m Word64 -&gt; ParsecT s u m Word64
forall a b. ParsecT s u m a -&gt; ParsecT s u m b -&gt; ParsecT s u m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT s u m Word64
forall {u}. ParsecT s u m Word64
</span><a href="#local-6989586621679063497"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT s u m Word64
-&gt; (Word64 -&gt; ParsecT s u m Word64) -&gt; ParsecT s u m Word64
forall a b.
ParsecT s u m a -&gt; (a -&gt; ParsecT s u m b) -&gt; ParsecT s u m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Word64 -&gt; ParsecT s u m Word64
</span><a href="#local-6989586621679063498"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679063517"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; ParsecT s u m Word64)
-&gt; (Word64 -&gt; Word64) -&gt; Word64 -&gt; ParsecT s u m Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679063518"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>    </span><span id="local-6989586621679063497"><span class="annot"><span class="annottext">dd :: ParsecT s u m Word64
</span><a href="#local-6989586621679063497"><span class="hs-identifier hs-var hs-var">dd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word64) -&gt; (Char -&gt; Int) -&gt; Char -&gt; Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">digitToInt</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Word64) -&gt; ParsecT s u m Char -&gt; ParsecT s u m Word64
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT s u m Char
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">digit</span></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="hs-comment">-- | A parser for a gtin number with an arbitrary number of digits between two and nineteen. the parser does not /end/ after the gtin (so no 'eof' is required).</span><span>
</span><span id="line-445"></span><span class="hs-comment">-- The GTIN is validated, so if the checksum does not match, the parser fails. The parser parses the number of digits with an arbitrary number of spaces between any two digits.</span><span>
</span><span id="line-446"></span><span class="annot"><a href="Data.Trade.GTIN.html#gtinParser_"><span class="hs-identifier hs-type">gtinParser_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679063526"><span class="annot"><a href="#local-6989586621679063526"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679063527"><span class="annot"><a href="#local-6989586621679063527"><span class="hs-identifier hs-type">u</span></a></span></span><span> </span><span id="local-6989586621679063528"><span class="annot"><a href="#local-6989586621679063528"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679063529"><span class="annot"><a href="#local-6989586621679063529"><span class="hs-identifier hs-type">n</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679063529"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><a href="#local-6989586621679063529"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679063529"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stream</span></span><span> </span><span class="annot"><a href="#local-6989586621679063526"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063528"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-449"></span><span>  </span><span class="annot"><span class="hs-comment">-- | A parser parsing a GTIN with an arbitrary number of digits that does /not/ force the stream to end, but checks the checksum.</span></span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ParsecT</span></span><span> </span><span class="annot"><a href="#local-6989586621679063526"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063527"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063528"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063529"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span id="gtinParser_"><span class="annot"><span class="annottext">gtinParser_ :: forall s u (m :: * -&gt; *) (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s m Char) =&gt;
ParsecT s u m (GTIN n)
</span><a href="Data.Trade.GTIN.html#gtinParser_"><span class="hs-identifier hs-var hs-var">gtinParser_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT s u m (GTIN n)
forall s u (m :: * -&gt; *) (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s m Char) =&gt;
ParsecT s u m (GTIN n)
</span><a href="Data.Trade.GTIN.html#gtinParser_%27"><span class="hs-identifier hs-var">gtinParser_'</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT s u m (GTIN n)
-&gt; (GTIN n -&gt; ParsecT s u m (GTIN n)) -&gt; ParsecT s u m (GTIN n)
forall a b.
ParsecT s u m a -&gt; (a -&gt; ParsecT s u m b) -&gt; ParsecT s u m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Either [Char] (GTIN n) -&gt; ParsecT s u m (GTIN n)
forall s (m :: * -&gt; *) a.
(Show s, MonadFail m) =&gt;
Either s a -&gt; m a
</span><a href="Data.Trade.GTIN.html#_liftEither"><span class="hs-identifier hs-var">_liftEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either [Char] (GTIN n) -&gt; ParsecT s u m (GTIN n))
-&gt; (GTIN n -&gt; Either [Char] (GTIN n))
-&gt; GTIN n
-&gt; ParsecT s u m (GTIN n)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Either [Char] (GTIN n)
forall a. Validity a =&gt; a -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">prettyValidate</span></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-comment">-- | A parser for a gtin number with an arbitrary number of digits between two and nineteen. the parser forces the stream to /end/ after the gtin,</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- but does /not/ validate if the gtin is indeed valid. The parser parses the number of digits with an arbitrary number of spaces between any two digits.</span><span>
</span><span id="line-455"></span><span class="annot"><a href="Data.Trade.GTIN.html#gtinParser%27"><span class="hs-identifier hs-type">gtinParser'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679063550"><span class="annot"><a href="#local-6989586621679063550"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679063551"><span class="annot"><a href="#local-6989586621679063551"><span class="hs-identifier hs-type">u</span></a></span></span><span> </span><span id="local-6989586621679063552"><span class="annot"><a href="#local-6989586621679063552"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679063553"><span class="annot"><a href="#local-6989586621679063553"><span class="hs-identifier hs-type">n</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679063553"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><a href="#local-6989586621679063553"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679063553"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stream</span></span><span> </span><span class="annot"><a href="#local-6989586621679063550"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063552"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-458"></span><span>  </span><span class="annot"><span class="hs-comment">-- | A parser parsing a GTIN with an arbitrary number of digits thats force the stream to end, but does /not/ check the checksum.</span></span><span>
</span><span id="line-459"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ParsecT</span></span><span> </span><span class="annot"><a href="#local-6989586621679063550"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063551"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063552"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063553"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span id="gtinParser%27"><span class="annot"><span class="annottext">gtinParser' :: forall s u (m :: * -&gt; *) (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s m Char) =&gt;
ParsecT s u m (GTIN n)
</span><a href="Data.Trade.GTIN.html#gtinParser%27"><span class="hs-identifier hs-var hs-var">gtinParser'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT s u m (GTIN n)
forall s u (m :: * -&gt; *) (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s m Char) =&gt;
ParsecT s u m (GTIN n)
</span><a href="Data.Trade.GTIN.html#gtinParser_%27"><span class="hs-identifier hs-var">gtinParser_'</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT s u m (GTIN n)
-&gt; ParsecT s u m () -&gt; ParsecT s u m (GTIN n)
forall a b. ParsecT s u m a -&gt; ParsecT s u m b -&gt; ParsecT s u m a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT s u m ()
forall s (m :: * -&gt; *) t u.
(Stream s m t, Show t) =&gt;
ParsecT s u m ()
</span><span class="hs-identifier hs-var">eof</span></span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="hs-comment">-- | A parser for a gtin number with an arbitrary number of digits between two and nineteen. the parser forces the stream to /end/ after the gtin,</span><span>
</span><span id="line-463"></span><span class="hs-comment">-- and validates if the gtin is indeed valid. The parser parses the number of digits with an arbitrary number of spaces between any two digits.</span><span>
</span><span id="line-464"></span><span class="annot"><a href="Data.Trade.GTIN.html#gtinParser"><span class="hs-identifier hs-type">gtinParser</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679063570"><span class="annot"><a href="#local-6989586621679063570"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679063571"><span class="annot"><a href="#local-6989586621679063571"><span class="hs-identifier hs-type">u</span></a></span></span><span> </span><span id="local-6989586621679063572"><span class="annot"><a href="#local-6989586621679063572"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679063573"><span class="annot"><a href="#local-6989586621679063573"><span class="hs-identifier hs-type">n</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679063573"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><a href="#local-6989586621679063573"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679063573"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stream</span></span><span> </span><span class="annot"><a href="#local-6989586621679063570"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063572"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-467"></span><span>  </span><span class="annot"><span class="hs-comment">-- | A parser parsing a GTIN with an arbitrary number of digits that forces the stream to end, and does checks the checksum.</span></span><span>
</span><span id="line-468"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ParsecT</span></span><span> </span><span class="annot"><a href="#local-6989586621679063570"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063571"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063572"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063573"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span id="gtinParser"><span class="annot"><span class="annottext">gtinParser :: forall s u (m :: * -&gt; *) (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s m Char) =&gt;
ParsecT s u m (GTIN n)
</span><a href="Data.Trade.GTIN.html#gtinParser"><span class="hs-identifier hs-var hs-var">gtinParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT s u m (GTIN n)
forall s u (m :: * -&gt; *) (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s m Char) =&gt;
ParsecT s u m (GTIN n)
</span><a href="Data.Trade.GTIN.html#gtinParser_"><span class="hs-identifier hs-var">gtinParser_</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT s u m (GTIN n)
-&gt; ParsecT s u m () -&gt; ParsecT s u m (GTIN n)
forall a b. ParsecT s u m a -&gt; ParsecT s u m b -&gt; ParsecT s u m a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT s u m ()
forall s (m :: * -&gt; *) t u.
(Stream s m t, Show t) =&gt;
ParsecT s u m ()
</span><span class="hs-identifier hs-var">eof</span></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="annot"><span class="hs-comment">-- | Run the 'gtinParser_'' parser and thus parses a 'GTIN' with an arbitrary number of digits. The parser does not require the stream to end after the 'GTIN', and does /not/ validate the checksum.</span></span><span>
</span><span id="line-472"></span><span class="annot"><a href="Data.Trade.GTIN.html#parseGTIN_%27"><span class="hs-identifier hs-type">parseGTIN_'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679062583"><span class="annot"><a href="#local-6989586621679062583"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679062584"><span class="annot"><a href="#local-6989586621679062584"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679062583"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><a href="#local-6989586621679062583"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062583"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stream</span></span><span> </span><span class="annot"><a href="#local-6989586621679062584"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-475"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The stream to parse.</span></span><span>
</span><span id="line-476"></span><span>  </span><span class="annot"><a href="#local-6989586621679062584"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-477"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The result of the parser: 'Either' a 'ParseError' or the parsed 'GTIN'.</span></span><span>
</span><span id="line-478"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ParseError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062583"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span id="parseGTIN_%27"><span class="annot"><span class="annottext">parseGTIN_' :: forall (n :: Natural) s.
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s Identity Char) =&gt;
s -&gt; Either ParseError (GTIN n)
</span><a href="Data.Trade.GTIN.html#parseGTIN_%27"><span class="hs-identifier hs-var hs-var">parseGTIN_'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec s () (GTIN n)
-&gt; () -&gt; [Char] -&gt; s -&gt; Either ParseError (GTIN n)
forall s t u a.
Stream s Identity t =&gt;
Parsec s u a -&gt; u -&gt; [Char] -&gt; s -&gt; Either ParseError a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parsec s () (GTIN n)
forall s u (m :: * -&gt; *) (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s m Char) =&gt;
ParsecT s u m (GTIN n)
</span><a href="Data.Trade.GTIN.html#gtinParser_%27"><span class="hs-identifier hs-var">gtinParser_'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span class="annot"><span class="hs-comment">-- | Run the 'gtinParser_'' parser and thus parses a 'GTIN' with an arbitrary number of digits. The parser requires the stream to end after the 'GTIN', but does /not/ validate the checksum.</span></span><span>
</span><span id="line-482"></span><span class="annot"><a href="Data.Trade.GTIN.html#parseGTIN%27"><span class="hs-identifier hs-type">parseGTIN'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679063602"><span class="annot"><a href="#local-6989586621679063602"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679063603"><span class="annot"><a href="#local-6989586621679063603"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-484"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679063602"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><a href="#local-6989586621679063602"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679063602"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stream</span></span><span> </span><span class="annot"><a href="#local-6989586621679063603"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-485"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The stream to parse.</span></span><span>
</span><span id="line-486"></span><span>  </span><span class="annot"><a href="#local-6989586621679063603"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-487"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The result of the parser: 'Either' a 'ParseError' or the parsed 'GTIN'.</span></span><span>
</span><span id="line-488"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ParseError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063602"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span id="parseGTIN%27"><span class="annot"><span class="annottext">parseGTIN' :: forall (n :: Natural) s.
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s Identity Char) =&gt;
s -&gt; Either ParseError (GTIN n)
</span><a href="Data.Trade.GTIN.html#parseGTIN%27"><span class="hs-identifier hs-var hs-var">parseGTIN'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec s () (GTIN n)
-&gt; () -&gt; [Char] -&gt; s -&gt; Either ParseError (GTIN n)
forall s t u a.
Stream s Identity t =&gt;
Parsec s u a -&gt; u -&gt; [Char] -&gt; s -&gt; Either ParseError a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parsec s () (GTIN n)
forall s u (m :: * -&gt; *) (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s m Char) =&gt;
ParsecT s u m (GTIN n)
</span><a href="Data.Trade.GTIN.html#gtinParser%27"><span class="hs-identifier hs-var">gtinParser'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="annot"><span class="hs-comment">-- | Run the 'gtinParser_'' parser and thus parses a 'GTIN' with an arbitrary number of digits. The parser does not require the stream to end after the 'GTIN', but validates the checksum.</span></span><span>
</span><span id="line-492"></span><span class="annot"><a href="Data.Trade.GTIN.html#parseGTIN_"><span class="hs-identifier hs-type">parseGTIN_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-493"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679063617"><span class="annot"><a href="#local-6989586621679063617"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679063618"><span class="annot"><a href="#local-6989586621679063618"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-494"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679063617"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><a href="#local-6989586621679063617"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679063617"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stream</span></span><span> </span><span class="annot"><a href="#local-6989586621679063618"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-495"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The stream to parse.</span></span><span>
</span><span id="line-496"></span><span>  </span><span class="annot"><a href="#local-6989586621679063618"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-497"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The result of the parser: 'Either' a 'ParseError' or the parsed 'GTIN'.</span></span><span>
</span><span id="line-498"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ParseError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063617"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span id="parseGTIN_"><span class="annot"><span class="annottext">parseGTIN_ :: forall (n :: Natural) s.
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s Identity Char) =&gt;
s -&gt; Either ParseError (GTIN n)
</span><a href="Data.Trade.GTIN.html#parseGTIN_"><span class="hs-identifier hs-var hs-var">parseGTIN_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec s () (GTIN n)
-&gt; () -&gt; [Char] -&gt; s -&gt; Either ParseError (GTIN n)
forall s t u a.
Stream s Identity t =&gt;
Parsec s u a -&gt; u -&gt; [Char] -&gt; s -&gt; Either ParseError a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parsec s () (GTIN n)
forall s u (m :: * -&gt; *) (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s m Char) =&gt;
ParsecT s u m (GTIN n)
</span><a href="Data.Trade.GTIN.html#gtinParser_"><span class="hs-identifier hs-var">gtinParser_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span class="annot"><span class="hs-comment">-- | Run the 'gtinParser_'' parser and thus parses a 'GTIN' with an arbitrary number of digits. The parser requires the stream to end after the 'GTIN', and validates the checksum.</span></span><span>
</span><span id="line-502"></span><span class="annot"><a href="Data.Trade.GTIN.html#parseGTIN"><span class="hs-identifier hs-type">parseGTIN</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-503"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679063632"><span class="annot"><a href="#local-6989586621679063632"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679063633"><span class="annot"><a href="#local-6989586621679063633"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-504"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679063632"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><a href="#local-6989586621679063632"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679063632"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stream</span></span><span> </span><span class="annot"><a href="#local-6989586621679063633"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-505"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The stream to parse.</span></span><span>
</span><span id="line-506"></span><span>  </span><span class="annot"><a href="#local-6989586621679063633"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-507"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The result of the parser: 'Either' a 'ParseError' or the parsed 'GTIN'.</span></span><span>
</span><span id="line-508"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ParseError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063632"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span id="parseGTIN"><span class="annot"><span class="annottext">parseGTIN :: forall (n :: Natural) s.
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s Identity Char) =&gt;
s -&gt; Either ParseError (GTIN n)
</span><a href="Data.Trade.GTIN.html#parseGTIN"><span class="hs-identifier hs-var hs-var">parseGTIN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec s () (GTIN n)
-&gt; () -&gt; [Char] -&gt; s -&gt; Either ParseError (GTIN n)
forall s t u a.
Stream s Identity t =&gt;
Parsec s u a -&gt; u -&gt; [Char] -&gt; s -&gt; Either ParseError a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parsec s () (GTIN n)
forall s u (m :: * -&gt; *) (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s m Char) =&gt;
ParsecT s u m (GTIN n)
</span><a href="Data.Trade.GTIN.html#gtinParser"><span class="hs-identifier hs-var">gtinParser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span class="annot"><span class="hs-comment">-- | A function that constructs a 'GTIN' expression or pattern based on a given string. The 'Proxy' parameter is used to specify the number of digits of the 'GTIN' number.</span></span><span>
</span><span id="line-512"></span><span class="annot"><a href="Data.Trade.GTIN.html#gtinQ"><span class="hs-identifier hs-type">gtinQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-513"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679062600"><span class="annot"><a href="#local-6989586621679062600"><span class="hs-identifier hs-type">n</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679062600"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator hs-type">(TN.&lt;=)</span></span><span> </span><span class="annot"><a href="#local-6989586621679062600"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-number">19</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679062600"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-515"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The 'Proxy' object that is ignored, but used to determine the number of digits of the 'GTIN' number.</span></span><span>
</span><span id="line-516"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Trade.GTIN.html#GTIN"><span class="hs-identifier hs-type">GTIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062600"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-517"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The corresponding 'QuasiQuoter' that resolves to a 'GTIN' expression or pattern.</span></span><span>
</span><span id="line-518"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-519"></span><span id="gtinQ"><span class="annot"><span class="annottext">gtinQ :: forall (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n) =&gt;
Proxy (GTIN n) -&gt; QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtinQ"><span class="hs-identifier hs-var hs-var">gtinQ</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy (GTIN n)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-520"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-521"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">quoteExp :: [Char] -&gt; Q Exp
</span><span class="hs-identifier hs-var">quoteExp</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either ParseError (GTIN n) -&gt; Q (GTIN n)
forall s (m :: * -&gt; *) a.
(Show s, MonadFail m) =&gt;
Either s a -&gt; m a
</span><a href="Data.Trade.GTIN.html#_liftEither"><span class="hs-identifier hs-var">_liftEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ParseError (GTIN n) -&gt; Q (GTIN n))
-&gt; (GTIN n -&gt; Q Exp) -&gt; Either ParseError (GTIN n) -&gt; Q Exp
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Q Exp
forall t (m :: * -&gt; *). (Lift t, Quote m) =&gt; t -&gt; m Exp
forall (m :: * -&gt; *). Quote m =&gt; GTIN n -&gt; m Exp
</span><span class="hs-identifier hs-var">lift</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either ParseError (GTIN n) -&gt; Q Exp)
-&gt; ([Char] -&gt; Either ParseError (GTIN n)) -&gt; [Char] -&gt; Q Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (n :: Natural) s.
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s Identity Char) =&gt;
s -&gt; Either ParseError (GTIN n)
</span><a href="Data.Trade.GTIN.html#parseGTIN"><span class="hs-identifier hs-var">parseGTIN</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679062600"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-522"></span><span>      </span><span class="annot"><span class="annottext">quotePat :: [Char] -&gt; Q Pat
</span><span class="hs-identifier hs-var">quotePat</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either ParseError (GTIN n) -&gt; Q (GTIN n)
forall s (m :: * -&gt; *) a.
(Show s, MonadFail m) =&gt;
Either s a -&gt; m a
</span><a href="Data.Trade.GTIN.html#_liftEither"><span class="hs-identifier hs-var">_liftEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ParseError (GTIN n) -&gt; Q (GTIN n))
-&gt; (GTIN n -&gt; Q Pat) -&gt; Either ParseError (GTIN n) -&gt; Q Pat
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Q Pat
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; Q Pat) -&gt; (GTIN n -&gt; Pat) -&gt; GTIN n -&gt; Q Pat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GTIN n -&gt; Pat
forall (n :: Natural). GTIN n -&gt; Pat
</span><a href="Data.Trade.GTIN.html#_toPattern"><span class="hs-identifier hs-var">_toPattern</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either ParseError (GTIN n) -&gt; Q Pat)
-&gt; ([Char] -&gt; Either ParseError (GTIN n)) -&gt; [Char] -&gt; Q Pat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (n :: Natural) s.
(2 &lt;= n, n &lt;= 19, KnownNat n, Stream s Identity Char) =&gt;
s -&gt; Either ParseError (GTIN n)
</span><a href="Data.Trade.GTIN.html#parseGTIN"><span class="hs-identifier hs-var">parseGTIN</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679062600"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-523"></span><span>      </span><span class="annot"><span class="annottext">quoteType :: [Char] -&gt; Q Type
</span><span class="hs-identifier hs-var">quoteType</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; [Char] -&gt; Q Type
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Q Type
forall a. [Char] -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;can not produce a type with this QuasiQuoter&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-524"></span><span>      </span><span class="annot"><span class="annottext">quoteDec :: [Char] -&gt; Q [Dec]
</span><span class="hs-identifier hs-var">quoteDec</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q [Dec] -&gt; [Char] -&gt; Q [Dec]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Q [Dec]
forall a. [Char] -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;can not produce a declaration with this QuasiQuoter&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="annot"><span class="hs-comment">-- | A 'QuasiQuoter' for an 'SSCC' number.</span></span><span>
</span><span id="line-528"></span><span class="annot"><a href="Data.Trade.GTIN.html#ssccQ"><span class="hs-identifier hs-type">ssccQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-529"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The corresponding 'QuasiQuoter'.</span></span><span>
</span><span id="line-530"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-531"></span><span id="ssccQ"><span class="annot"><span class="annottext">ssccQ :: QuasiQuoter
</span><a href="Data.Trade.GTIN.html#ssccQ"><span class="hs-identifier hs-var hs-var">ssccQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n) =&gt;
Proxy (GTIN n) -&gt; QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtinQ"><span class="hs-identifier hs-var">gtinQ</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">18</span></span><span> </span><span class="annot"><span class="annottext">Proxy (GTIN 18)
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span class="annot"><span class="hs-comment">-- | A 'QuasiQuoter' for a 'GSIN' number.</span></span><span>
</span><span id="line-534"></span><span class="annot"><a href="Data.Trade.GTIN.html#gsinQ"><span class="hs-identifier hs-type">gsinQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-535"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The corresponding 'QuasiQuoter'.</span></span><span>
</span><span id="line-536"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-537"></span><span id="gsinQ"><span class="annot"><span class="annottext">gsinQ :: QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gsinQ"><span class="hs-identifier hs-var hs-var">gsinQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n) =&gt;
Proxy (GTIN n) -&gt; QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtinQ"><span class="hs-identifier hs-var">gtinQ</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">17</span></span><span> </span><span class="annot"><span class="annottext">Proxy (GTIN 17)
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span class="annot"><span class="hs-comment">-- | A 'QuasiQuoter' for an 'GTIN14' number.</span></span><span>
</span><span id="line-540"></span><span class="annot"><a href="Data.Trade.GTIN.html#gtin14Q"><span class="hs-identifier hs-type">gtin14Q</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-541"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The corresponding 'QuasiQuoter'.</span></span><span>
</span><span id="line-542"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-543"></span><span id="gtin14Q"><span class="annot"><span class="annottext">gtin14Q :: QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtin14Q"><span class="hs-identifier hs-var hs-var">gtin14Q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n) =&gt;
Proxy (GTIN n) -&gt; QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtinQ"><span class="hs-identifier hs-var">gtinQ</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">14</span></span><span> </span><span class="annot"><span class="annottext">Proxy (GTIN 14)
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span class="annot"><span class="hs-comment">-- | A 'QuasiQuoter' for an 'EANUCC14' number.</span></span><span>
</span><span id="line-546"></span><span class="annot"><a href="Data.Trade.GTIN.html#eanucc14Q"><span class="hs-identifier hs-type">eanucc14Q</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-547"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The corresponding 'QuasiQuoter'.</span></span><span>
</span><span id="line-548"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-549"></span><span id="eanucc14Q"><span class="annot"><span class="annottext">eanucc14Q :: QuasiQuoter
</span><a href="Data.Trade.GTIN.html#eanucc14Q"><span class="hs-identifier hs-var hs-var">eanucc14Q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtin14Q"><span class="hs-identifier hs-var">gtin14Q</span></a></span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="annot"><span class="hs-comment">-- | A 'QuasiQuoter' for an 'SCC14' number.</span></span><span>
</span><span id="line-552"></span><span class="annot"><a href="Data.Trade.GTIN.html#scc14Q"><span class="hs-identifier hs-type">scc14Q</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-553"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The corresponding 'QuasiQuoter'.</span></span><span>
</span><span id="line-554"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-555"></span><span id="scc14Q"><span class="annot"><span class="annottext">scc14Q :: QuasiQuoter
</span><a href="Data.Trade.GTIN.html#scc14Q"><span class="hs-identifier hs-var hs-var">scc14Q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtin14Q"><span class="hs-identifier hs-var">gtin14Q</span></a></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="annot"><span class="hs-comment">-- | A 'QuasiQuoter' for an 'GTIN13' number.</span></span><span>
</span><span id="line-558"></span><span class="annot"><a href="Data.Trade.GTIN.html#gtin13Q"><span class="hs-identifier hs-type">gtin13Q</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-559"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The corresponding 'QuasiQuoter'.</span></span><span>
</span><span id="line-560"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-561"></span><span id="gtin13Q"><span class="annot"><span class="annottext">gtin13Q :: QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtin13Q"><span class="hs-identifier hs-var hs-var">gtin13Q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n) =&gt;
Proxy (GTIN n) -&gt; QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtinQ"><span class="hs-identifier hs-var">gtinQ</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">13</span></span><span> </span><span class="annot"><span class="annottext">Proxy ISBN13
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-562"></span><span>
</span><span id="line-563"></span><span class="annot"><span class="hs-comment">-- | A 'QuasiQuoter' for an 'EAN' number.</span></span><span>
</span><span id="line-564"></span><span class="annot"><a href="Data.Trade.GTIN.html#eanQ"><span class="hs-identifier hs-type">eanQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-565"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The corresponding 'QuasiQuoter'.</span></span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-567"></span><span id="eanQ"><span class="annot"><span class="annottext">eanQ :: QuasiQuoter
</span><a href="Data.Trade.GTIN.html#eanQ"><span class="hs-identifier hs-var hs-var">eanQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtin13Q"><span class="hs-identifier hs-var">gtin13Q</span></a></span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span class="annot"><span class="hs-comment">-- | A 'QuasiQuoter' for an 'EANUCC13' number.</span></span><span>
</span><span id="line-570"></span><span class="annot"><a href="Data.Trade.GTIN.html#eanucc13Q"><span class="hs-identifier hs-type">eanucc13Q</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-571"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The corresponding 'QuasiQuoter'.</span></span><span>
</span><span id="line-572"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-573"></span><span id="eanucc13Q"><span class="annot"><span class="annottext">eanucc13Q :: QuasiQuoter
</span><a href="Data.Trade.GTIN.html#eanucc13Q"><span class="hs-identifier hs-var hs-var">eanucc13Q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtin13Q"><span class="hs-identifier hs-var">gtin13Q</span></a></span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span class="annot"><span class="hs-comment">-- | A 'QuasiQuoter' for an 'GTIN12' number.</span></span><span>
</span><span id="line-576"></span><span class="annot"><a href="Data.Trade.GTIN.html#gtin12Q"><span class="hs-identifier hs-type">gtin12Q</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-577"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The corresponding 'QuasiQuoter'.</span></span><span>
</span><span id="line-578"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-579"></span><span id="gtin12Q"><span class="annot"><span class="annottext">gtin12Q :: QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtin12Q"><span class="hs-identifier hs-var hs-var">gtin12Q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n) =&gt;
Proxy (GTIN n) -&gt; QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtinQ"><span class="hs-identifier hs-var">gtinQ</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">12</span></span><span> </span><span class="annot"><span class="annottext">Proxy (GTIN 12)
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span class="annot"><span class="hs-comment">-- | A 'QuasiQuoter' for an 'GTIN8' number.</span></span><span>
</span><span id="line-582"></span><span class="annot"><a href="Data.Trade.GTIN.html#gtin8Q"><span class="hs-identifier hs-type">gtin8Q</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-583"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The corresponding 'QuasiQuoter'.</span></span><span>
</span><span id="line-584"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-585"></span><span id="gtin8Q"><span class="annot"><span class="annottext">gtin8Q :: QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtin8Q"><span class="hs-identifier hs-var hs-var">gtin8Q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n) =&gt;
Proxy (GTIN n) -&gt; QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtinQ"><span class="hs-identifier hs-var">gtinQ</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Proxy (GTIN 8)
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span class="annot"><span class="hs-comment">-- | A 'QuasiQuoter' for an 'EANUCC8' number.</span></span><span>
</span><span id="line-588"></span><span class="annot"><a href="Data.Trade.GTIN.html#eanucc8Q"><span class="hs-identifier hs-type">eanucc8Q</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-589"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The corresponding 'QuasiQuoter'.</span></span><span>
</span><span id="line-590"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-591"></span><span id="eanucc8Q"><span class="annot"><span class="annottext">eanucc8Q :: QuasiQuoter
</span><a href="Data.Trade.GTIN.html#eanucc8Q"><span class="hs-identifier hs-var hs-var">eanucc8Q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtin8Q"><span class="hs-identifier hs-var">gtin8Q</span></a></span><span>
</span><span id="line-592"></span><span>
</span><span id="line-593"></span><span class="annot"><span class="hs-comment">-- | A 'QuasiQuoter' for an 'ISBN13' number.</span></span><span>
</span><span id="line-594"></span><span class="annot"><a href="Data.Trade.GTIN.html#isbn13Q"><span class="hs-identifier hs-type">isbn13Q</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-595"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The corresponding 'QuasiQuoter'.</span></span><span>
</span><span id="line-596"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-597"></span><span id="isbn13Q"><span class="annot"><span class="annottext">isbn13Q :: QuasiQuoter
</span><a href="Data.Trade.GTIN.html#isbn13Q"><span class="hs-identifier hs-var hs-var">isbn13Q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (n :: Natural).
(2 &lt;= n, n &lt;= 19, KnownNat n) =&gt;
Proxy (GTIN n) -&gt; QuasiQuoter
</span><a href="Data.Trade.GTIN.html#gtinQ"><span class="hs-identifier hs-var">gtinQ</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">13</span></span><span> </span><span class="annot"><span class="annottext">Proxy ISBN13
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="annot"><span class="hs-comment">-- | A 'QuasiQuoter' for an 'ISBN' number, only the thirteen digit number is supported.</span></span><span>
</span><span id="line-600"></span><span class="annot"><a href="Data.Trade.GTIN.html#isbnQ"><span class="hs-identifier hs-type">isbnQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-601"></span><span>  </span><span class="annot"><span class="hs-comment">-- | The corresponding 'QuasiQuoter'.</span></span><span>
</span><span id="line-602"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-603"></span><span id="isbnQ"><span class="annot"><span class="annottext">isbnQ :: QuasiQuoter
</span><a href="Data.Trade.GTIN.html#isbnQ"><span class="hs-identifier hs-var hs-var">isbnQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuasiQuoter
</span><a href="Data.Trade.GTIN.html#isbn13Q"><span class="hs-identifier hs-var">isbn13Q</span></a></span><span>
</span><span id="line-604"></span></pre></body></html>