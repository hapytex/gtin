<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DefaultSignatures #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE MagicHash #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-redundant-constraints #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">--    @Validity@ is used to specify additional invariants upon values that are not</span><span>
</span><span id="line-13"></span><span class="hs-comment">--    enforced by the type system.</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">--    Let's take an example.</span><span>
</span><span id="line-16"></span><span class="hs-comment">--    Suppose we were to implement a type @Prime@ that represents prime integers.</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">--    If you were to completely enforce the invariant that the represented number is</span><span>
</span><span id="line-19"></span><span class="hs-comment">--    a prime, then we could use 'Natural' and only store the index of the</span><span>
</span><span id="line-20"></span><span class="hs-comment">--    given prime in the infinite sequence of prime numbers.</span><span>
</span><span id="line-21"></span><span class="hs-comment">--    This is very safe but also very expensive if we ever want to use the number,</span><span>
</span><span id="line-22"></span><span class="hs-comment">--    because we would have to calculcate all the prime numbers until that index.</span><span>
</span><span id="line-23"></span><span class="hs-comment">--</span><span>
</span><span id="line-24"></span><span class="hs-comment">--    Instead we choose to implement @Prime@ by a @newtype Prime = Prime Int@.</span><span>
</span><span id="line-25"></span><span class="hs-comment">--    Now we have to maintain the invariant that the @Int@ that we use to represent</span><span>
</span><span id="line-26"></span><span class="hs-comment">--    the prime is in fact positive and a prime.</span><span>
</span><span id="line-27"></span><span class="hs-comment">--</span><span>
</span><span id="line-28"></span><span class="hs-comment">--    The @Validity@ typeclass allows us to specify this invariant (and enables</span><span>
</span><span id="line-29"></span><span class="hs-comment">--    testing via the @genvalidity@ libraries:</span><span>
</span><span id="line-30"></span><span class="hs-comment">--    https://hackage.haskell.org/package/genvalidity ):</span><span>
</span><span id="line-31"></span><span class="hs-comment">--</span><span>
</span><span id="line-32"></span><span class="hs-comment">--    &gt; instance Validity Prime where</span><span>
</span><span id="line-33"></span><span class="hs-comment">--    &gt;     validate (Prime n) = check (isPrime n) &quot;The 'Int' is prime.&quot;</span><span>
</span><span id="line-34"></span><span class="hs-comment">--</span><span>
</span><span id="line-35"></span><span class="hs-comment">--    If certain typeclass invariants exist, you can make these explicit in the</span><span>
</span><span id="line-36"></span><span class="hs-comment">--    validity instance as well.</span><span>
</span><span id="line-37"></span><span class="hs-comment">--    For example, 'Fixed a' is only valid if 'a' has an 'HasResolution' instance,</span><span>
</span><span id="line-38"></span><span class="hs-comment">--    so the correct validity instance is @HasResolution a =&gt; Validity (Fixed a)@.</span><span>
</span><span id="line-39"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Validity</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier">Validity</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Helper functions to define 'validate'</span></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier">trivialValidation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Data.Validity.html#genericValidate"><span class="hs-identifier">genericValidate</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Data.Validity.html#check"><span class="hs-identifier">check</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Data.Validity.html#declare"><span class="hs-identifier">declare</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Data.Validity.html#annotate"><span class="hs-identifier">annotate</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Data.Validity.html#delve"><span class="hs-identifier">delve</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Data.Validity.html#decorate"><span class="hs-identifier">decorate</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Data.Validity.html#decorateList"><span class="hs-identifier">decorateList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Data.Validity.html#invalid"><span class="hs-identifier">invalid</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="Data.Validity.html#valid"><span class="hs-identifier">valid</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Helpers for specific types</span></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** Char</span></span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="Data.Validity.html#validateCharNotUtf16SurrogateCodePoint"><span class="hs-identifier">validateCharNotUtf16SurrogateCodePoint</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="Data.Validity.html#isUtf16SurrogateCodePoint"><span class="hs-identifier">isUtf16SurrogateCodePoint</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><a href="Data.Validity.html#validateCharNotLineSeparator"><span class="hs-identifier">validateCharNotLineSeparator</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><a href="Data.Validity.html#isLineSeparator"><span class="hs-identifier">isLineSeparator</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="Data.Validity.html#validateStringSingleLine"><span class="hs-identifier">validateStringSingleLine</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="Data.Validity.html#isSingleLine"><span class="hs-identifier">isSingleLine</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** RealFloat (Double)</span></span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><a href="Data.Validity.html#validateNotNaN"><span class="hs-identifier">validateNotNaN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><a href="Data.Validity.html#validateNotInfinite"><span class="hs-identifier">validateNotInfinite</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** Ratio</span></span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><a href="Data.Validity.html#validateRatioNotNaN"><span class="hs-identifier">validateRatioNotNaN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="Data.Validity.html#validateRatioNotInfinite"><span class="hs-identifier">validateRatioNotInfinite</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="Data.Validity.html#validateRatioNormalised"><span class="hs-identifier">validateRatioNormalised</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Utilities</span></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Utilities for validity checking</span></span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="Data.Validity.html#isValid"><span class="hs-identifier">isValid</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><a href="Data.Validity.html#isInvalid"><span class="hs-identifier">isInvalid</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><a href="Data.Validity.html#constructValid"><span class="hs-identifier">constructValid</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><a href="Data.Validity.html#constructValidUnsafe"><span class="hs-identifier">constructValidUnsafe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Utilities for validation</span></span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier">Validation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><a href="Data.Validity.html#ValidationChain"><span class="hs-identifier">ValidationChain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><a href="Data.Validity.html#checkValidity"><span class="hs-identifier">checkValidity</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><a href="Data.Validity.html#validationIsValid"><span class="hs-identifier">validationIsValid</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><a href="Data.Validity.html#prettyValidate"><span class="hs-identifier">prettyValidate</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="Data.Validity.html#prettyValidation"><span class="hs-identifier">prettyValidation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Re-exports</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><span class="hs-identifier">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="hs-identifier">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(.&amp;.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ord</span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isRight</span></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Fixed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Fixed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MkFixed</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasResolution</span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(:|)</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if MIN_VERSION_base(4,16,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Char</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isTrue#</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ord#</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;=#)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&gt;=#)</span></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Exts</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Char</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">isTrue#</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">leWord#</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ord#</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;=#</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&gt;=#</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int16</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Int32</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Int8</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Natural</span></span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Real</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ratio</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word16</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word32</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word64</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word8</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="annot"><span class="hs-comment">-- | A class of types that have additional invariants defined upon them</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">--</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- === Purpose</span><span>
</span><span id="line-118"></span><span class="hs-comment">--</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- 'validate' checks whether a given value is a valid value and reports all</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- reasons why the given value is not valid if that is the case.</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- 'isValid' only checks whether a given value is a valid value of its type.</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- It is a helper function that checks that 'validate' says that there are</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- no reasons why the value is invalid.</span><span>
</span><span id="line-125"></span><span class="hs-comment">--</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- === Instantiating 'Validity'</span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- To instantiate 'Validity', one has to implement only 'validate'.</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- Use the helper functions below to define all the reasons why a given</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- value would be a valid value of its type.</span><span>
</span><span id="line-131"></span><span class="hs-comment">--</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-133"></span><span class="hs-comment">--</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- &gt; newtype Even = Even Int</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- &gt; instance Validity Even</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- &gt;     validate (Event i)</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- &gt;       even i &lt;?@&gt; &quot;The contained 'Int' is even.&quot;</span><span>
</span><span id="line-139"></span><span class="hs-comment">--</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- === Semantics</span><span>
</span><span id="line-141"></span><span class="hs-comment">--</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- 'validate' should be an underapproximation of actual validity.</span><span>
</span><span id="line-143"></span><span class="hs-comment">--</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- This means that if 'isValid' is not a perfect representation of actual</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- validity, for safety reasons, it should never return 'True' for invalid</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- values, but it may return 'False' for valid values.</span><span>
</span><span id="line-147"></span><span class="hs-comment">--</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-149"></span><span class="hs-comment">--</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- &gt; validate = const $ invalid &quot;always&quot;</span><span>
</span><span id="line-151"></span><span class="hs-comment">--</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- is a valid implementation for any type, because now 'isValid' never returns</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- 'True' for invalid values.</span><span>
</span><span id="line-154"></span><span class="hs-comment">--</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- &gt; validate (Even i) = declare &quot;The integer is equal to two&quot; $ i == 2</span><span>
</span><span id="line-156"></span><span class="hs-comment">--</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- is a valid implementation for @newtype Even = Even Int@, but</span><span>
</span><span id="line-158"></span><span class="hs-comment">--</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- &gt; validate (Even i) = declare &quot;The integer is even or equal to one&quot; $ even i || i == 1</span><span>
</span><span id="line-160"></span><span class="hs-comment">--</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- is not because then `isValid` returns 'True' for an invalid value: '1'.</span><span>
</span><span id="line-162"></span><span class="hs-comment">--</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- === Automatic instances with 'Generic'</span><span>
</span><span id="line-164"></span><span class="hs-comment">--</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- An instance of this class can be made automatically if the type in question</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- has a 'Generic' instance. This instance will try to use 'valid' to</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- on all structural sub-parts of the value that is being checked for validity.</span><span>
</span><span id="line-168"></span><span class="hs-comment">--</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-170"></span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- &gt; {-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- &gt; data MyType = MyType</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- &gt;     { myDouble :: Double</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- &gt;     { myString :: String</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- &gt;     } deriving (Show, Eq, Generic)</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- &gt; instance Validity MyType</span><span>
</span><span id="line-179"></span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- generates something like:</span><span>
</span><span id="line-181"></span><span class="hs-comment">--</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- &gt; instance Validity MyType where</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- &gt;     validate (MyType d s)</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- &gt;         = annotate d &quot;myDouble&quot;</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- &gt;        &lt;&gt; annotate s &quot;myString&quot;</span><span>
</span><span id="line-186"></span><span class="hs-keyword">class</span><span> </span><span id="Validity"><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-var">Validity</span></a></span></span><span> </span><span id="local-6989586621679035268"><span class="annot"><a href="#local-6989586621679035268"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>  </span><span id="validate"><span class="annot"><a href="Data.Validity.html#validate"><span class="hs-identifier hs-type">validate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679035268"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="validate"><span class="annot"><a href="Data.Validity.html#validate"><span class="hs-identifier hs-type">validate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="annot"><a href="#local-6989586621679035268"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="annot"><a href="#local-6989586621679035268"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><a href="#local-6989586621679035268"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span id="local-6989586621679035522"><span class="annot"><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var">validate</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Validation
forall a. (Generic a, GValidity (Rep a)) =&gt; a -&gt; Validation
</span><a href="Data.Validity.html#genericValidate"><span class="hs-identifier hs-var">genericValidate</span></a></span></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span id="local-6989586621679035271"><span class="annot"><a href="Data.Validity.html#genericValidate"><span class="hs-identifier hs-type">genericValidate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="annot"><a href="#local-6989586621679035271"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="annot"><a href="#local-6989586621679035271"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679035271"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span></span><span>
</span><span id="line-195"></span><span id="genericValidate"><span class="annot"><span class="annottext">genericValidate :: forall a. (Generic a, GValidity (Rep a)) =&gt; a -&gt; Validation
</span><a href="Data.Validity.html#genericValidate"><span class="hs-identifier hs-var hs-var">genericValidate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rep a Any -&gt; Validation
forall a. Rep a a -&gt; Validation
forall (f :: * -&gt; *) a. GValidity f =&gt; f a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var">gValidate</span></a></span><span> </span><span class="annot"><span class="annottext">(Rep a Any -&gt; Validation) -&gt; (a -&gt; Rep a Any) -&gt; a -&gt; Validation
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Rep a Any
forall x. a -&gt; Rep a x
forall a x. Generic a =&gt; a -&gt; Rep a x
</span><span class="hs-identifier hs-var">from</span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-keyword">data</span><span> </span><span id="ValidationChain"><span class="annot"><a href="Data.Validity.html#ValidationChain"><span class="hs-identifier hs-var">ValidationChain</span></a></span></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Violated"><span class="annot"><a href="Data.Validity.html#Violated"><span class="hs-identifier hs-var">Violated</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Location"><span class="annot"><a href="Data.Validity.html#Location"><span class="hs-identifier hs-var">Location</span></a></span></span><span>
</span><span id="line-200"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-201"></span><span>      </span><span class="annot"><a href="Data.Validity.html#ValidationChain"><span class="hs-identifier hs-type">ValidationChain</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679035537"><span id="local-6989586621679035548"><span id="local-6989586621679035551"><span class="annot"><span class="annottext">Int -&gt; ValidationChain -&gt; ShowS
[ValidationChain] -&gt; ShowS
ValidationChain -&gt; String
(Int -&gt; ValidationChain -&gt; ShowS)
-&gt; (ValidationChain -&gt; String)
-&gt; ([ValidationChain] -&gt; ShowS)
-&gt; Show ValidationChain
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ValidationChain -&gt; ShowS
showsPrec :: Int -&gt; ValidationChain -&gt; ShowS
$cshow :: ValidationChain -&gt; String
show :: ValidationChain -&gt; String
$cshowList :: [ValidationChain] -&gt; ShowS
showList :: [ValidationChain] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035556"><span id="local-6989586621679035564"><span class="annot"><span class="annottext">ValidationChain -&gt; ValidationChain -&gt; Bool
(ValidationChain -&gt; ValidationChain -&gt; Bool)
-&gt; (ValidationChain -&gt; ValidationChain -&gt; Bool)
-&gt; Eq ValidationChain
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ValidationChain -&gt; ValidationChain -&gt; Bool
== :: ValidationChain -&gt; ValidationChain -&gt; Bool
$c/= :: ValidationChain -&gt; ValidationChain -&gt; Bool
/= :: ValidationChain -&gt; ValidationChain -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035569"><span id="local-6989586621679035571"><span class="annot"><span class="annottext">(forall x. ValidationChain -&gt; Rep ValidationChain x)
-&gt; (forall x. Rep ValidationChain x -&gt; ValidationChain)
-&gt; Generic ValidationChain
forall x. Rep ValidationChain x -&gt; ValidationChain
forall x. ValidationChain -&gt; Rep ValidationChain x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. ValidationChain -&gt; Rep ValidationChain x
from :: forall x. ValidationChain -&gt; Rep ValidationChain x
$cto :: forall x. Rep ValidationChain x -&gt; ValidationChain
to :: forall x. Rep ValidationChain x -&gt; ValidationChain
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035575"><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="Data.Validity.html#ValidationChain"><span class="hs-identifier hs-type">ValidationChain</span></a></span></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- | The result of validating a value.</span><span>
</span><span id="line-207"></span><span class="hs-comment">--</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- `mempty` means the value was valid.</span><span>
</span><span id="line-209"></span><span class="hs-comment">--</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- This type intentionally doesn't have a `Validity` instance to make sure</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- you can never accidentally use `annotate` or `delve` twice.</span><span>
</span><span id="line-212"></span><span class="hs-keyword">newtype</span><span> </span><span id="Validation"><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-var">Validation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Validation"><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-var">Validation</span></a></span></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="unValidation"><span class="annot"><span class="annottext">Validation -&gt; [ValidationChain]
</span><a href="Data.Validity.html#unValidation"><span class="hs-identifier hs-var hs-var">unValidation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Validity.html#ValidationChain"><span class="hs-identifier hs-type">ValidationChain</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679035627"><span id="local-6989586621679035632"><span id="local-6989586621679035636"><span class="annot"><span class="annottext">Int -&gt; Validation -&gt; ShowS
[Validation] -&gt; ShowS
Validation -&gt; String
(Int -&gt; Validation -&gt; ShowS)
-&gt; (Validation -&gt; String)
-&gt; ([Validation] -&gt; ShowS)
-&gt; Show Validation
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Validation -&gt; ShowS
showsPrec :: Int -&gt; Validation -&gt; ShowS
$cshow :: Validation -&gt; String
show :: Validation -&gt; String
$cshowList :: [Validation] -&gt; ShowS
showList :: [Validation] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035639"><span id="local-6989586621679035644"><span class="annot"><span class="annottext">Validation -&gt; Validation -&gt; Bool
(Validation -&gt; Validation -&gt; Bool)
-&gt; (Validation -&gt; Validation -&gt; Bool) -&gt; Eq Validation
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Validation -&gt; Validation -&gt; Bool
== :: Validation -&gt; Validation -&gt; Bool
$c/= :: Validation -&gt; Validation -&gt; Bool
/= :: Validation -&gt; Validation -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035650"><span id="local-6989586621679035652"><span class="annot"><span class="annottext">(forall x. Validation -&gt; Rep Validation x)
-&gt; (forall x. Rep Validation x -&gt; Validation) -&gt; Generic Validation
forall x. Rep Validation x -&gt; Validation
forall x. Validation -&gt; Rep Validation x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. Validation -&gt; Rep Validation x
from :: forall x. Validation -&gt; Rep Validation x
$cto :: forall x. Rep Validation x -&gt; Validation
to :: forall x. Rep Validation x -&gt; Validation
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035656"><span id="local-6989586621679035660"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span> </span><span id="local-6989586621679035665"><span class="annot"><span class="annottext">[ValidationChain]
</span><a href="#local-6989586621679035665"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679035666"><span class="annot"><span class="annottext">&lt;&gt; :: Validation -&gt; Validation -&gt; Validation
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span> </span><span id="local-6989586621679035667"><span class="annot"><span class="annottext">[ValidationChain]
</span><a href="#local-6989586621679035667"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ValidationChain] -&gt; Validation
</span><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-var">Validation</span></a></span><span> </span><span class="annot"><span class="annottext">([ValidationChain] -&gt; Validation)
-&gt; [ValidationChain] -&gt; Validation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ValidationChain]
</span><a href="#local-6989586621679035665"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">[ValidationChain] -&gt; [ValidationChain] -&gt; [ValidationChain]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[ValidationChain]
</span><a href="#local-6989586621679035667"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035673"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-221"></span><span>  </span><span id="local-6989586621679035676"><span class="annot"><span class="annottext">mempty :: Validation
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ValidationChain] -&gt; Validation
</span><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-var">Validation</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-222"></span><span>  </span><span id="local-6989586621679035678"><span class="annot"><span class="annottext">mappend :: Validation -&gt; Validation -&gt; Validation
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Validation -&gt; Validation -&gt; Validation
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Declare any value to be valid in validation</span><span>
</span><span id="line-225"></span><span class="hs-comment">--</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- &gt; trivialValidation a = seq a mempty</span><span>
</span><span id="line-227"></span><span id="local-6989586621679035326"><span class="annot"><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-type">trivialValidation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679035326"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span></span><span>
</span><span id="line-228"></span><span id="trivialValidation"><span class="annot"><span class="annottext">trivialValidation :: forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var hs-var">trivialValidation</span></a></span></span><span> </span><span id="local-6989586621679035680"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035680"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Validation -&gt; Validation
forall a b. a -&gt; b -&gt; b
</span><span class="hs-identifier hs-var">seq</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035680"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Validation
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | Check that a given invariant holds.</span><span>
</span><span id="line-231"></span><span class="hs-comment">--</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- The given string should describe the invariant, not the violation.</span><span>
</span><span id="line-233"></span><span class="hs-comment">--</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-235"></span><span class="hs-comment">--</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- &gt; check (x &lt; 5) &quot;x is strictly smaller than 5&quot;</span><span>
</span><span id="line-237"></span><span class="hs-comment">--</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- instead of</span><span>
</span><span id="line-239"></span><span class="hs-comment">--</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- &gt; check (x &lt; 5) &quot;x is greater than 5&quot;</span><span>
</span><span id="line-241"></span><span class="annot"><a href="Data.Validity.html#check"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span>
</span><span id="line-242"></span><span id="check"><span class="annot"><span class="annottext">check :: Bool -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#check"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span id="local-6989586621679035681"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679035681"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679035682"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679035682"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679035681"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Validation
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[ValidationChain] -&gt; Validation
</span><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-var">Validation</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; ValidationChain
</span><a href="Data.Validity.html#Violated"><span class="hs-identifier hs-var">Violated</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679035682"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="annot"><span class="hs-comment">-- | 'check', but with the arguments flipped</span></span><span>
</span><span id="line-248"></span><span class="annot"><a href="Data.Validity.html#declare"><span class="hs-identifier hs-type">declare</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span>
</span><span id="line-249"></span><span id="declare"><span class="annot"><span class="annottext">declare :: String -&gt; Bool -&gt; Validation
</span><a href="Data.Validity.html#declare"><span class="hs-identifier hs-var hs-var">declare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; String -&gt; Validation) -&gt; String -&gt; Bool -&gt; Validation
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#check"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | Declare a sub-part as a necessary part for validation, and annotate it with a name.</span><span>
</span><span id="line-252"></span><span class="hs-comment">--</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-254"></span><span class="hs-comment">--</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- &gt; validate (a, b) =</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- &gt;     mconcat</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- &gt;         [ annotate a &quot;The first element of the tuple&quot;</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- &gt;         , annotate b &quot;The second element of the tuple&quot;</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- &gt;         ]</span><span>
</span><span id="line-260"></span><span id="local-6989586621679035333"><span class="annot"><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-type">annotate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035333"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679035333"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span></span><span>
</span><span id="line-261"></span><span id="annotate"><span class="annot"><span class="annottext">annotate :: forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var hs-var">annotate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Validation -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotateValidation"><span class="hs-identifier hs-var">annotateValidation</span></a></span><span> </span><span class="annot"><span class="annottext">(Validation -&gt; String -&gt; Validation)
-&gt; (a -&gt; Validation) -&gt; a -&gt; String -&gt; Validation
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Validation
forall a. Validity a =&gt; a -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var">validate</span></a></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="annot"><span class="hs-comment">-- | 'annotate', but with the arguments flipped.</span></span><span>
</span><span id="line-264"></span><span id="local-6989586621679035335"><span class="annot"><a href="Data.Validity.html#delve"><span class="hs-identifier hs-type">delve</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035335"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679035335"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span></span><span>
</span><span id="line-265"></span><span id="delve"><span class="annot"><span class="annottext">delve :: forall a. Validity a =&gt; String -&gt; a -&gt; Validation
</span><a href="Data.Validity.html#delve"><span class="hs-identifier hs-var hs-var">delve</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; String -&gt; Validation) -&gt; String -&gt; a -&gt; Validation
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="annot"><span class="hs-comment">-- | Decorate a validation with a location</span></span><span>
</span><span id="line-268"></span><span class="annot"><a href="Data.Validity.html#decorate"><span class="hs-identifier hs-type">decorate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span>
</span><span id="line-269"></span><span id="decorate"><span class="annot"><span class="annottext">decorate :: String -&gt; Validation -&gt; Validation
</span><a href="Data.Validity.html#decorate"><span class="hs-identifier hs-var hs-var">decorate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Validation -&gt; String -&gt; Validation)
-&gt; String -&gt; Validation -&gt; Validation
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Validation -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotateValidation"><span class="hs-identifier hs-var">annotateValidation</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><span class="hs-comment">-- | Decorate a piecewise validation of a list with their location in the list</span></span><span>
</span><span id="line-272"></span><span id="local-6989586621679035337"><span class="annot"><a href="Data.Validity.html#decorateList"><span class="hs-identifier hs-type">decorateList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679035337"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679035337"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span></span><span>
</span><span id="line-273"></span><span id="decorateList"><span class="annot"><span class="annottext">decorateList :: forall a. [a] -&gt; (a -&gt; Validation) -&gt; Validation
</span><a href="Data.Validity.html#decorateList"><span class="hs-identifier hs-var hs-var">decorateList</span></a></span></span><span> </span><span id="local-6989586621679035696"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679035696"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679035697"><span class="annot"><span class="annottext">a -&gt; Validation
</span><a href="#local-6989586621679035697"><span class="hs-identifier hs-var">func</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Validation] -&gt; Validation
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Validation] -&gt; Validation) -&gt; [Validation] -&gt; Validation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><span class="annottext">(((Integer, a) -&gt; Validation) -&gt; [(Integer, a)] -&gt; [Validation])
-&gt; [(Integer, a)] -&gt; ((Integer, a) -&gt; Validation) -&gt; [Validation]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((Integer, a) -&gt; Validation) -&gt; [(Integer, a)] -&gt; [Validation]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Integer] -&gt; [a] -&gt; [(Integer, a)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679035696"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Integer, a) -&gt; Validation) -&gt; [Validation])
-&gt; ((Integer, a) -&gt; Validation) -&gt; [Validation]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679035698"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679035698"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035699"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035699"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Validation -&gt; Validation
</span><a href="Data.Validity.html#decorate"><span class="hs-identifier hs-var">decorate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The element at index&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679035698"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;in the list&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Validation -&gt; Validation) -&gt; Validation -&gt; Validation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-276"></span><span>      </span><span class="annot"><span class="annottext">a -&gt; Validation
</span><a href="#local-6989586621679035697"><span class="hs-identifier hs-var">func</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035699"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- | Construct a trivially invalid 'Validation'</span><span>
</span><span id="line-279"></span><span class="hs-comment">--</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-281"></span><span class="hs-comment">--</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- &gt; data Wrong</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- &gt;     = Wrong</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- &gt;     | Fine</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- &gt;     deriving (Show, Eq)</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- &gt; instance Validity Wrong where</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- &gt;     validate w =</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- &gt;         case w of</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- &gt;             Wrong -&gt; invalid &quot;Wrong&quot;</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- &gt;             Fine -&gt; valid</span><span>
</span><span id="line-292"></span><span class="annot"><a href="Data.Validity.html#invalid"><span class="hs-identifier hs-type">invalid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span>
</span><span id="line-293"></span><span id="invalid"><span class="annot"><span class="annottext">invalid :: String -&gt; Validation
</span><a href="Data.Validity.html#invalid"><span class="hs-identifier hs-var hs-var">invalid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#check"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="annot"><a href="Data.Validity.html#valid"><span class="hs-identifier hs-type">valid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span>
</span><span id="line-296"></span><span id="valid"><span class="annot"><span class="annottext">valid :: Validation
</span><a href="Data.Validity.html#valid"><span class="hs-identifier hs-var hs-var">valid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Validation
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="annot"><span class="hs-comment">-- | Any tuple of things is valid if both of its elements are valid</span></span><span>
</span><span id="line-299"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035345"><span id="local-6989586621679035346"><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035345"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035346"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679035345"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679035346"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>  </span><span id="local-6989586621679035709"><span class="annot"><span class="annottext">validate :: (a, b) -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679035710"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035710"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035711"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679035711"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><span class="annottext">[Validation] -&gt; Validation
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-302"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035710"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The first element of the tuple&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-303"></span><span>        </span><span class="annot"><span class="annottext">b -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679035711"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The second element of the tuple&quot;</span></span><span>
</span><span id="line-304"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="annot"><span class="hs-comment">-- | Any Either of things is valid if the contents are valid in either of the cases.</span></span><span>
</span><span id="line-307"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035349"><span id="local-6989586621679035350"><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035349"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035350"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679035349"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035350"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621679035718"><span class="annot"><span class="annottext">validate :: Either a b -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679035719"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035719"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035719"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The 'Left'&quot;</span></span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var">validate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679035720"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679035720"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679035720"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The 'Right'&quot;</span></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="annot"><span class="hs-comment">-- | Any triple of things is valid if all three of its elements are valid</span></span><span>
</span><span id="line-312"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035354"><span id="local-6989586621679035355"><span id="local-6989586621679035356"><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035354"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035355"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035356"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679035354"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679035355"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679035356"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>  </span><span id="local-6989586621679035730"><span class="annot"><span class="annottext">validate :: (a, b, c) -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679035731"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035731"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035732"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679035732"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035733"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679035733"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><span class="annottext">[Validation] -&gt; Validation
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-315"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035731"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The first element of the triple&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-316"></span><span>        </span><span class="annot"><span class="annottext">b -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679035732"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The second element of the triple&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-317"></span><span>        </span><span class="annot"><span class="annottext">c -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679035733"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The third element of the triple&quot;</span></span><span>
</span><span id="line-318"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="annot"><span class="hs-comment">-- | Any quadruple of things is valid if all four of its elements are valid</span></span><span>
</span><span id="line-321"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-322"></span><span>  </span><span id="local-6989586621679035361"><span id="local-6989586621679035362"><span id="local-6989586621679035363"><span id="local-6989586621679035364"><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035361"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035362"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035363"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035364"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679035361"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679035362"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679035363"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679035364"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621679035745"><span class="annot"><span class="annottext">validate :: (a, b, c, d) -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679035746"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035746"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035747"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679035747"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035748"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679035748"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035749"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679035749"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><span class="annottext">[Validation] -&gt; Validation
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-327"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035746"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The first element of the quadruple&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-328"></span><span>        </span><span class="annot"><span class="annottext">b -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679035747"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The second element of the quadruple&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-329"></span><span>        </span><span class="annot"><span class="annottext">c -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679035748"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The third element of the quadruple&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-330"></span><span>        </span><span class="annot"><span class="annottext">d -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679035749"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The fourth element of the quadruple&quot;</span></span><span>
</span><span id="line-331"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="annot"><span class="hs-comment">-- | Any quintuple of things is valid if all five of its elements are valid</span></span><span>
</span><span id="line-334"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-335"></span><span>  </span><span id="local-6989586621679035370"><span id="local-6989586621679035371"><span id="local-6989586621679035372"><span id="local-6989586621679035373"><span id="local-6989586621679035374"><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035370"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035371"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035372"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035373"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035374"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-336"></span><span>  </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679035370"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679035371"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679035372"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679035373"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679035374"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-338"></span><span>  </span><span id="local-6989586621679035763"><span class="annot"><span class="annottext">validate :: (a, b, c, d, e) -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679035764"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035764"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035765"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679035765"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035766"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679035766"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035767"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679035767"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035768"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679035768"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><span class="annottext">[Validation] -&gt; Validation
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-340"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035764"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The first element of the quintuple&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-341"></span><span>        </span><span class="annot"><span class="annottext">b -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679035765"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The second element of the quintuple&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-342"></span><span>        </span><span class="annot"><span class="annottext">c -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679035766"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The third element of the quintuple&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-343"></span><span>        </span><span class="annot"><span class="annottext">d -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679035767"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The fourth element of the quintuple&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-344"></span><span>        </span><span class="annot"><span class="annottext">e -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679035768"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The fifth element of the quintuple&quot;</span></span><span>
</span><span id="line-345"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="annot"><span class="hs-comment">-- | Any sextuple of things is valid if all six of its elements are valid</span></span><span>
</span><span id="line-348"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-349"></span><span>  </span><span id="local-6989586621679035381"><span id="local-6989586621679035382"><span id="local-6989586621679035383"><span id="local-6989586621679035384"><span id="local-6989586621679035385"><span id="local-6989586621679035386"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035381"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035382"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035383"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035384"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035385"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-354"></span><span>    </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035386"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679035381"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679035382"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679035383"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679035384"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679035385"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679035386"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-358"></span><span>  </span><span id="local-6989586621679035784"><span class="annot"><span class="annottext">validate :: (a, b, c, d, e, f) -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679035785"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035785"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035786"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679035786"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035787"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679035787"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035788"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679035788"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035789"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679035789"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679035790"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679035790"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><span class="annottext">[Validation] -&gt; Validation
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-360"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035785"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The first element of the sextuple&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-361"></span><span>        </span><span class="annot"><span class="annottext">b -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679035786"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The second element of the sextuple&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-362"></span><span>        </span><span class="annot"><span class="annottext">c -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679035787"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The third element of the sextuple&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-363"></span><span>        </span><span class="annot"><span class="annottext">d -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679035788"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The fourth element of the sextuple&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-364"></span><span>        </span><span class="annot"><span class="annottext">e -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679035789"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The fifth element of the sextuple&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-365"></span><span>        </span><span class="annot"><span class="annottext">f -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679035790"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The sixth element of the sextuple&quot;</span></span><span>
</span><span id="line-366"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">-- | A list of things is valid if all of the things are valid.</span><span>
</span><span id="line-369"></span><span class="hs-comment">--</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- This means that the empty list is considered valid.</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- If the empty list should not be considered valid as part of your custom data</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- type, make sure to write a custom @Validity instance@</span><span>
</span><span id="line-373"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035316"><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035316"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679035316"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621679035794"><span class="annot"><span class="annottext">validate :: [a] -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; (a -&gt; Validation) -&gt; Validation)
-&gt; (a -&gt; Validation) -&gt; [a] -&gt; Validation
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; (a -&gt; Validation) -&gt; Validation
forall a. [a] -&gt; (a -&gt; Validation) -&gt; Validation
</span><a href="Data.Validity.html#decorateList"><span class="hs-identifier hs-var">decorateList</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Validation
forall a. Validity a =&gt; a -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var">validate</span></a></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">-- | A nonempty list is valid if all the elements are valid.</span><span>
</span><span id="line-377"></span><span class="hs-comment">--</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- See the instance for 'Validity [a]' for more information.</span><span>
</span><span id="line-379"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035389"><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035389"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679035389"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-380"></span><span>  </span><span id="local-6989586621679035801"><span class="annot"><span class="annottext">validate :: NonEmpty a -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679035802"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035802"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621679035803"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679035803"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-381"></span><span>    </span><span class="annot"><span class="annottext">[Validation] -&gt; Validation
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-382"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035802"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The first element of the nonempty list&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-383"></span><span>        </span><span class="annot"><span class="annottext">[a] -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679035803"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The rest of the elements of the nonempty list&quot;</span></span><span>
</span><span id="line-384"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | A Maybe thing is valid if the thing inside is valid or it's nothing</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- It makes sense to assume that 'Nothing' is valid.</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- If Nothing wasn't valid, you wouldn't have used a Maybe</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- in the datastructure.</span><span>
</span><span id="line-390"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035391"><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035391"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679035391"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-391"></span><span>  </span><span id="local-6989586621679035809"><span class="annot"><span class="annottext">validate :: Maybe a -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Validation
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-392"></span><span>  </span><span class="annot"><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var">validate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679035810"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035810"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035810"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The 'Just'&quot;</span></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="annot"><span class="hs-comment">-- | Trivially valid</span></span><span>
</span><span id="line-395"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-396"></span><span>  </span><span id="local-6989586621679035813"><span class="annot"><span class="annottext">validate :: () -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="annot"><span class="hs-comment">-- | Trivially valid</span></span><span>
</span><span id="line-399"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>  </span><span id="local-6989586621679035816"><span class="annot"><span class="annottext">validate :: Bool -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="annot"><span class="hs-comment">-- | Trivially valid</span></span><span>
</span><span id="line-403"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-404"></span><span>  </span><span id="local-6989586621679035819"><span class="annot"><span class="annottext">validate :: Ordering -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="annot"><span class="hs-comment">-- | Trivially valid</span></span><span>
</span><span id="line-407"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-408"></span><span>  </span><span id="local-6989586621679035822"><span class="annot"><span class="annottext">validate :: Char -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C#</span></span><span> </span><span id="local-6989586621679035823"><span class="annot"><span class="annottext">Char#
</span><a href="#local-6989586621679035823"><span class="hs-identifier hs-var">c#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-409"></span><span>    </span><span class="annot"><span class="annottext">[Validation] -&gt; Validation
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-410"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Validation
</span><a href="Data.Validity.html#declare"><span class="hs-identifier hs-var">declare</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The contained value is positive&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Validation) -&gt; Bool -&gt; Validation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char# -&gt; Int#
</span><span class="hs-identifier hs-var">ord#</span></span><span> </span><span class="annot"><span class="annottext">Char#
</span><a href="#local-6989586621679035823"><span class="hs-identifier hs-var">c#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&gt;=#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-411"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Validation
</span><a href="Data.Validity.html#declare"><span class="hs-identifier hs-var">declare</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The contained value is smaller than 0x10FFFF = 1114111&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Validation) -&gt; Bool -&gt; Validation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char# -&gt; Int#
</span><span class="hs-identifier hs-var">ord#</span></span><span> </span><span class="annot"><span class="annottext">Char#
</span><a href="#local-6989586621679035823"><span class="hs-identifier hs-var">c#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&lt;=#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1114111#</span></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="annot"><a href="Data.Validity.html#validateCharNotUtf16SurrogateCodePoint"><span class="hs-identifier hs-type">validateCharNotUtf16SurrogateCodePoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span>
</span><span id="line-415"></span><span id="validateCharNotUtf16SurrogateCodePoint"><span class="annot"><span class="annottext">validateCharNotUtf16SurrogateCodePoint :: Char -&gt; Validation
</span><a href="Data.Validity.html#validateCharNotUtf16SurrogateCodePoint"><span class="hs-identifier hs-var hs-var">validateCharNotUtf16SurrogateCodePoint</span></a></span></span><span> </span><span id="local-6989586621679035824"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679035824"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-416"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Validation
</span><a href="Data.Validity.html#declare"><span class="hs-identifier hs-var">declare</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The character is not a UTF16 surrogate codepoint&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Validation) -&gt; Bool -&gt; Validation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Data.Validity.html#isUtf16SurrogateCodePoint"><span class="hs-identifier hs-var">isUtf16SurrogateCodePoint</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679035824"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="annot"><a href="Data.Validity.html#isUtf16SurrogateCodePoint"><span class="hs-identifier hs-type">isUtf16SurrogateCodePoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-419"></span><span id="isUtf16SurrogateCodePoint"><span class="annot"><span class="annottext">isUtf16SurrogateCodePoint :: Char -&gt; Bool
</span><a href="Data.Validity.html#isUtf16SurrogateCodePoint"><span class="hs-identifier hs-var hs-var">isUtf16SurrogateCodePoint</span></a></span></span><span> </span><span id="local-6989586621679035826"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679035826"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679035826"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x1ff800</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0xd800</span></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span class="annot"><a href="Data.Validity.html#validateCharNotLineSeparator"><span class="hs-identifier hs-type">validateCharNotLineSeparator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span>
</span><span id="line-422"></span><span id="validateCharNotLineSeparator"><span class="annot"><span class="annottext">validateCharNotLineSeparator :: Char -&gt; Validation
</span><a href="Data.Validity.html#validateCharNotLineSeparator"><span class="hs-identifier hs-var hs-var">validateCharNotLineSeparator</span></a></span></span><span> </span><span id="local-6989586621679035827"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679035827"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-423"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Validation
</span><a href="Data.Validity.html#declare"><span class="hs-identifier hs-var">declare</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The character is not a line separator&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Validation) -&gt; Bool -&gt; Validation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Data.Validity.html#isLineSeparator"><span class="hs-identifier hs-var">isLineSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679035827"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="annot"><a href="Data.Validity.html#isLineSeparator"><span class="hs-identifier hs-type">isLineSeparator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-426"></span><span id="isLineSeparator"><span class="annot"><span class="annottext">isLineSeparator :: Char -&gt; Bool
</span><a href="Data.Validity.html#isLineSeparator"><span class="hs-identifier hs-var hs-var">isLineSeparator</span></a></span></span><span> </span><span id="local-6989586621679035828"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679035828"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679035828"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-427"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-428"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\r'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-429"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="annot"><a href="Data.Validity.html#validateStringSingleLine"><span class="hs-identifier hs-type">validateStringSingleLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span>
</span><span id="line-432"></span><span id="validateStringSingleLine"><span class="annot"><span class="annottext">validateStringSingleLine :: String -&gt; Validation
</span><a href="Data.Validity.html#validateStringSingleLine"><span class="hs-identifier hs-var hs-var">validateStringSingleLine</span></a></span></span><span> </span><span id="local-6989586621679035829"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679035829"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Char -&gt; Validation) -&gt; Validation
forall a. [a] -&gt; (a -&gt; Validation) -&gt; Validation
</span><a href="Data.Validity.html#decorateList"><span class="hs-identifier hs-var">decorateList</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679035829"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Validation
</span><a href="Data.Validity.html#validateCharNotLineSeparator"><span class="hs-identifier hs-var">validateCharNotLineSeparator</span></a></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="annot"><a href="Data.Validity.html#isSingleLine"><span class="hs-identifier hs-type">isSingleLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-435"></span><span id="isSingleLine"><span class="annot"><span class="annottext">isSingleLine :: String -&gt; Bool
</span><a href="Data.Validity.html#isSingleLine"><span class="hs-identifier hs-var hs-var">isSingleLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (String -&gt; Bool) -&gt; String -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Data.Validity.html#isLineSeparator"><span class="hs-identifier hs-var">isLineSeparator</span></a></span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span class="annot"><span class="hs-comment">-- | Trivially valid</span></span><span>
</span><span id="line-438"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-439"></span><span>  </span><span id="local-6989586621679035833"><span class="annot"><span class="annottext">validate :: Int -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span class="hs-cpp">

#if MIN_VERSION_base(4,16,0)
</span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679035836"><span class="annot"><span class="annottext">validate :: Int8 -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int8 -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span>
</span><span id="line-443"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679035839"><span class="annot"><span class="annottext">validate :: Int16 -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span>
</span><span id="line-444"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679035842"><span class="annot"><span class="annottext">validate :: Int32 -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- | NOT trivially valid on GHC because small number types are represented using a 64bit structure underneath.</span><span>
</span><span id="line-447"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Validity</span><span> </span><span class="hs-identifier">Int8</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-identifier">validate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I8#</span><span> </span><span class="hs-identifier">i#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-449"></span><span>    </span><span class="hs-identifier">mconcat</span><span>
</span><span id="line-450"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">declare</span><span> </span><span class="hs-string">&quot;The contained integer is smaller than 2^7 = 128&quot;</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">isTrue#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i#</span><span> </span><span class="hs-operator">&lt;=#</span><span> </span><span class="hs-number">127#</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-451"></span><span>        </span><span class="hs-identifier">declare</span><span> </span><span class="hs-string">&quot;The contained integer is greater than or equal to -2^7 = -128&quot;</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">isTrue#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i#</span><span> </span><span class="hs-operator">&gt;=#</span><span> </span><span class="hs-number">-128#</span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="hs-comment">-- | NOT trivially valid on GHC because small number types are represented using a 64bit structure underneath.</span><span>
</span><span id="line-455"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Validity</span><span> </span><span class="hs-identifier">Int16</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-identifier">validate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I16#</span><span> </span><span class="hs-identifier">i#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-457"></span><span>    </span><span class="hs-identifier">mconcat</span><span>
</span><span id="line-458"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">declare</span><span> </span><span class="hs-string">&quot;The contained integer is smaller than 2^15 = 32768&quot;</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">isTrue#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i#</span><span> </span><span class="hs-operator">&lt;=#</span><span> </span><span class="hs-number">32767#</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-459"></span><span>        </span><span class="hs-identifier">declare</span><span> </span><span class="hs-string">&quot;The contained integer is greater than or equal to -2^15 = -32768&quot;</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">isTrue#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i#</span><span> </span><span class="hs-operator">&gt;=#</span><span> </span><span class="hs-number">-32768#</span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="hs-comment">-- | NOT trivially valid on GHC because small number types are represented using a 64bit structure underneath.</span><span>
</span><span id="line-463"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Validity</span><span> </span><span class="hs-identifier">Int32</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-identifier">validate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I32#</span><span> </span><span class="hs-identifier">i#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-identifier">mconcat</span><span>
</span><span id="line-466"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">declare</span><span> </span><span class="hs-string">&quot;The contained integer is smaller than 2^31 = 2147483648&quot;</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">isTrue#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i#</span><span> </span><span class="hs-operator">&lt;=#</span><span> </span><span class="hs-number">2147483647#</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-467"></span><span>        </span><span class="hs-identifier">declare</span><span> </span><span class="hs-string">&quot;The contained integer is greater than or equal to -2^31 = -2147483648&quot;</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">isTrue#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i#</span><span> </span><span class="hs-operator">&gt;=#</span><span> </span><span class="hs-number">-2147483648#</span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>      </span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-471"></span><span class="annot"><span class="hs-comment">-- | Trivially valid</span></span><span>
</span><span id="line-472"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-473"></span><span>  </span><span id="local-6989586621679035845"><span class="annot"><span class="annottext">validate :: Int64 -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="annot"><span class="hs-comment">-- | Trivially valid</span></span><span>
</span><span id="line-476"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-477"></span><span>  </span><span id="local-6989586621679035848"><span class="annot"><span class="annottext">validate :: Word -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span class="hs-cpp">

#if MIN_VERSION_base(4,16,0)
</span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679035851"><span class="annot"><span class="annottext">validate :: Word8 -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span>
</span><span id="line-481"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679035854"><span class="annot"><span class="annottext">validate :: Word16 -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span>
</span><span id="line-482"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679035857"><span class="annot"><span class="annottext">validate :: Word32 -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- | NOT trivially valid on GHC because small number types are represented using a 64bit structure underneath.</span><span>
</span><span id="line-485"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Validity</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-486"></span><span>  </span><span class="hs-identifier">validate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W8#</span><span> </span><span class="hs-identifier">w#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-identifier">declare</span><span> </span><span class="hs-string">&quot;The contained integer is smaller than 2^8 = 256&quot;</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">isTrue#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">w#</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">leWord#</span><span class="hs-special">`</span><span> </span><span class="hs-number">255##</span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="hs-comment">-- | NOT trivially valid on GHC because small number types are represented using a 64bit structure underneath.</span><span>
</span><span id="line-490"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Validity</span><span> </span><span class="hs-identifier">Word16</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-491"></span><span>  </span><span class="hs-identifier">validate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W16#</span><span> </span><span class="hs-identifier">w#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-492"></span><span>    </span><span class="hs-identifier">declare</span><span> </span><span class="hs-string">&quot;The contained integer is smaller than 2^16 = 65536&quot;</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">isTrue#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">w#</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">leWord#</span><span class="hs-special">`</span><span> </span><span class="hs-number">65535##</span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="hs-comment">-- | NOT trivially valid on GHC because small number types are represented using a 64bit structure underneath.</span><span>
</span><span id="line-495"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Validity</span><span> </span><span class="hs-identifier">Word32</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-496"></span><span>  </span><span class="hs-identifier">validate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W32#</span><span> </span><span class="hs-identifier">w#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-497"></span><span>    </span><span class="hs-identifier">declare</span><span> </span><span class="hs-string">&quot;The contained integer is smaller than 2^32 = 4294967296&quot;</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">isTrue#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">w#</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">leWord#</span><span class="hs-special">`</span><span> </span><span class="hs-number">4294967295##</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-500"></span><span class="annot"><span class="hs-comment">-- | Trivially valid</span></span><span>
</span><span id="line-501"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-502"></span><span>  </span><span id="local-6989586621679035860"><span class="annot"><span class="annottext">validate :: Word64 -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span class="annot"><span class="hs-comment">-- | Trivially valid:</span></span><span>
</span><span id="line-505"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-506"></span><span>  </span><span id="local-6989586621679035863"><span class="annot"><span class="annottext">validate :: Float -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="annot"><span class="hs-comment">-- | Trivially valid:</span></span><span>
</span><span id="line-509"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-510"></span><span>  </span><span id="local-6989586621679035866"><span class="annot"><span class="annottext">validate :: Double -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span id="local-6989586621679035395"><span class="annot"><a href="Data.Validity.html#validateNotNaN"><span class="hs-identifier hs-type">validateNotNaN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealFloat</span></span><span> </span><span class="annot"><a href="#local-6989586621679035395"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679035395"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span></span><span>
</span><span id="line-513"></span><span id="validateNotNaN"><span class="annot"><span class="annottext">validateNotNaN :: forall a. RealFloat a =&gt; a -&gt; Validation
</span><a href="Data.Validity.html#validateNotNaN"><span class="hs-identifier hs-var hs-var">validateNotNaN</span></a></span></span><span> </span><span id="local-6989586621679035869"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035869"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Validation
</span><a href="Data.Validity.html#declare"><span class="hs-identifier hs-var">declare</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The RealFloat is not NaN.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Validation) -&gt; Bool -&gt; Validation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isNaN</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035869"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span id="local-6989586621679035871"><span class="annot"><a href="Data.Validity.html#validateNotInfinite"><span class="hs-identifier hs-type">validateNotInfinite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealFloat</span></span><span> </span><span class="annot"><a href="#local-6989586621679035871"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679035871"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span></span><span>
</span><span id="line-516"></span><span id="validateNotInfinite"><span class="annot"><span class="annottext">validateNotInfinite :: forall a. RealFloat a =&gt; a -&gt; Validation
</span><a href="Data.Validity.html#validateNotInfinite"><span class="hs-identifier hs-var hs-var">validateNotInfinite</span></a></span></span><span> </span><span id="local-6989586621679035874"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035874"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Validation
</span><a href="Data.Validity.html#declare"><span class="hs-identifier hs-var">declare</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The RealFloat is not infinite.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Validation) -&gt; Bool -&gt; Validation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isInfinite</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035874"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span id="local-6989586621679035399"><span class="annot"><a href="Data.Validity.html#validateRatioNotNaN"><span class="hs-identifier hs-type">validateRatioNotNaN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679035399"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ratio</span></span><span> </span><span class="annot"><a href="#local-6989586621679035399"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span></span><span>
</span><span id="line-519"></span><span id="validateRatioNotNaN"><span class="annot"><span class="annottext">validateRatioNotNaN :: forall a. Integral a =&gt; Ratio a -&gt; Validation
</span><a href="Data.Validity.html#validateRatioNotNaN"><span class="hs-identifier hs-var hs-var">validateRatioNotNaN</span></a></span></span><span> </span><span id="local-6989586621679035889"><span class="annot"><span class="annottext">Ratio a
</span><a href="#local-6989586621679035889"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Validation
</span><a href="Data.Validity.html#declare"><span class="hs-identifier hs-var">declare</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The Ratio is not NaN.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Validation) -&gt; Bool -&gt; Validation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ratio a
</span><a href="#local-6989586621679035889"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-521"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:%</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-522"></span><span>    </span><span class="annot"><span class="annottext">Ratio a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span id="local-6989586621679035890"><span class="annot"><a href="Data.Validity.html#validateRatioNotInfinite"><span class="hs-identifier hs-type">validateRatioNotInfinite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679035890"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ratio</span></span><span> </span><span class="annot"><a href="#local-6989586621679035890"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span></span><span>
</span><span id="line-525"></span><span id="validateRatioNotInfinite"><span class="annot"><span class="annottext">validateRatioNotInfinite :: forall a. Integral a =&gt; Ratio a -&gt; Validation
</span><a href="Data.Validity.html#validateRatioNotInfinite"><span class="hs-identifier hs-var hs-var">validateRatioNotInfinite</span></a></span></span><span> </span><span id="local-6989586621679035905"><span class="annot"><span class="annottext">Ratio a
</span><a href="#local-6989586621679035905"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Validation
</span><a href="Data.Validity.html#declare"><span class="hs-identifier hs-var">declare</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The Ratio is not infinite.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Validation) -&gt; Bool -&gt; Validation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ratio a
</span><a href="#local-6989586621679035905"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-527"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:%</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-528"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:%</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-529"></span><span>    </span><span class="annot"><span class="annottext">Ratio a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span id="local-6989586621679035906"><span class="annot"><a href="Data.Validity.html#validateRatioNormalised"><span class="hs-identifier hs-type">validateRatioNormalised</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679035906"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ratio</span></span><span> </span><span class="annot"><a href="#local-6989586621679035906"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span></span><span>
</span><span id="line-532"></span><span id="validateRatioNormalised"><span class="annot"><span class="annottext">validateRatioNormalised :: forall a. Integral a =&gt; Ratio a -&gt; Validation
</span><a href="Data.Validity.html#validateRatioNormalised"><span class="hs-identifier hs-var hs-var">validateRatioNormalised</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679035916"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035916"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:%</span></span><span> </span><span id="local-6989586621679035917"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035917"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Validation
</span><a href="Data.Validity.html#declare"><span class="hs-identifier hs-var">declare</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The Ratio is normalised.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Validation) -&gt; Bool -&gt; Validation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-533"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035917"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-534"></span><span>    </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-535"></span><span>    </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-536"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679035924"><span class="annot"><span class="annottext">g :: a
</span><a href="#local-6989586621679035924"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">gcd</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035916"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035917"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-537"></span><span>          </span><span id="local-6989586621679035929"><span class="annot"><span class="annottext">gcdOverflows :: Bool
</span><a href="#local-6989586621679035929"><span class="hs-identifier hs-var hs-var">gcdOverflows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035924"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-538"></span><span>          </span><span id="local-6989586621679035938"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035938"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:%</span></span><span> </span><span id="local-6989586621679035939"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035939"><span class="hs-identifier hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035916"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035924"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ratio a
forall a. a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">:%</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035917"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035924"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>          </span><span id="local-6989586621679035944"><span class="annot"><span class="annottext">valueIsNormalised :: Bool
</span><a href="#local-6989586621679035944"><span class="hs-identifier hs-var hs-var">valueIsNormalised</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035938"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ratio a
forall a. a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">:%</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035939"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio a -&gt; Ratio a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035916"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ratio a
forall a. a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">:%</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035917"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-540"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679035929"><span class="hs-identifier hs-var">gcdOverflows</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679035944"><span class="hs-identifier hs-var">valueIsNormalised</span></a></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span class="hs-comment">-- | Trivially valid</span><span>
</span><span id="line-543"></span><span class="hs-comment">--</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- Integer is not trivially valid under the hood, but instantiating</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- 'Validity' correctly would force validity to depend on a specific</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- (big integer library @integer-gmp@ versus @integer-simple@).</span><span>
</span><span id="line-547"></span><span class="hs-comment">-- This is rather impractical so for the time being we have opted for</span><span>
</span><span id="line-548"></span><span class="hs-comment">-- assuming that an 'Integer' is always valid.</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- Even though this is not technically sound, it is good enough for now.</span><span>
</span><span id="line-550"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-551"></span><span>  </span><span id="local-6989586621679035948"><span class="annot"><span class="annottext">validate :: Integer -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span class="annot"><span class="hs-comment">-- | Valid according to 'isValidNatural'</span></span><span>
</span><span id="line-554"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-555"></span><span>  </span><span id="local-6989586621679035952"><span class="annot"><span class="annottext">validate :: Natural -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Validation
</span><a href="Data.Validity.html#declare"><span class="hs-identifier hs-var">declare</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The Natural is valid.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Validation) -&gt; (Natural -&gt; Bool) -&gt; Natural -&gt; Validation
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Bool
</span><span class="hs-identifier hs-var">isValidNatural</span></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="hs-comment">-- | Valid if the contained numbers are valid and the denominator is</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- strictly positive.</span><span>
</span><span id="line-559"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035410"><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035410"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679035410"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679035410"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679035410"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ratio</span></span><span> </span><span class="annot"><a href="#local-6989586621679035410"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-560"></span><span>  </span><span id="local-6989586621679035965"><span class="annot"><span class="annottext">validate :: Ratio a -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span id="local-6989586621679035966"><span class="annot"><span class="annottext">r :: Ratio a
</span><a href="#local-6989586621679035966"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679035967"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035967"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:%</span></span><span> </span><span id="local-6989586621679035968"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035968"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-561"></span><span>    </span><span class="annot"><span class="annottext">[Validation] -&gt; Validation
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-562"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035967"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The numerator&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-563"></span><span>        </span><span class="annot"><span class="annottext">a -&gt; String -&gt; Validation
forall a. Validity a =&gt; a -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotate"><span class="hs-identifier hs-var">annotate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035968"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The denominator&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-564"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Validation
</span><a href="Data.Validity.html#declare"><span class="hs-identifier hs-var">declare</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The denominator is strictly positive.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Validation) -&gt; Bool -&gt; Validation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679035968"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span>
</span><span id="line-565"></span><span>        </span><span class="annot"><span class="annottext">Ratio a -&gt; Validation
forall a. Integral a =&gt; Ratio a -&gt; Validation
</span><a href="Data.Validity.html#validateRatioNormalised"><span class="hs-identifier hs-var">validateRatioNormalised</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio a
</span><a href="#local-6989586621679035966"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-566"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-567"></span><span>
</span><span id="line-568"></span><span class="annot"><span class="hs-comment">-- | Valid according to the contained 'Integer'.</span></span><span>
</span><span id="line-569"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035414"><span class="annot"><span class="hs-identifier hs-type">HasResolution</span></span><span> </span><span class="annot"><a href="#local-6989586621679035414"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fixed</span></span><span> </span><span class="annot"><a href="#local-6989586621679035414"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-570"></span><span>  </span><span id="local-6989586621679035974"><span class="annot"><span class="annottext">validate :: Fixed a -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var hs-var hs-var hs-var">validate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MkFixed</span></span><span> </span><span id="local-6989586621679035975"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679035975"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Validation
forall a. Validity a =&gt; a -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var">validate</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679035975"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span class="annot"><a href="Data.Validity.html#annotateValidation"><span class="hs-identifier hs-type">annotateValidation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span>
</span><span id="line-573"></span><span id="annotateValidation"><span class="annot"><span class="annottext">annotateValidation :: Validation -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotateValidation"><span class="hs-identifier hs-var hs-var">annotateValidation</span></a></span></span><span> </span><span id="local-6989586621679035976"><span class="annot"><span class="annottext">Validation
</span><a href="#local-6989586621679035976"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679035977"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679035977"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-574"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Validation
</span><a href="#local-6989586621679035976"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-575"></span><span>    </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span> </span><span id="local-6989586621679035978"><span class="annot"><span class="annottext">[ValidationChain]
</span><a href="#local-6989586621679035978"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ValidationChain] -&gt; Validation
</span><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-var">Validation</span></a></span><span> </span><span class="annot"><span class="annottext">([ValidationChain] -&gt; Validation)
-&gt; [ValidationChain] -&gt; Validation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ValidationChain -&gt; ValidationChain)
-&gt; [ValidationChain] -&gt; [ValidationChain]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ValidationChain -&gt; ValidationChain
</span><a href="Data.Validity.html#Location"><span class="hs-identifier hs-var">Location</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679035977"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ValidationChain]
</span><a href="#local-6989586621679035978"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span class="hs-keyword">class</span><span> </span><span id="GValidity"><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-var">GValidity</span></a></span></span><span> </span><span id="local-6989586621679035274"><span class="annot"><a href="#local-6989586621679035274"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-578"></span><span>  </span><span id="gValidate"><span class="annot"><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-type">gValidate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679035273"><span class="annot"><a href="#local-6989586621679035274"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035273"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span></span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">U1</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-581"></span><span>  </span><span id="local-6989586621679035982"><span class="annot"><span class="annottext">gValidate :: forall a. U1 a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var hs-var hs-var hs-var">gValidate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">U1 a -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">V1</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-584"></span><span>  </span><span id="local-6989586621679035985"><span class="annot"><span class="annottext">gValidate :: forall a. V1 a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var hs-var hs-var hs-var">gValidate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V1 a -&gt; Validation
forall a. a -&gt; Validation
</span><a href="Data.Validity.html#trivialValidation"><span class="hs-identifier hs-var">trivialValidation</span></a></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035313"><span id="local-6989586621679035314"><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035313"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035314"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679035313"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679035314"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-587"></span><span>  </span><span id="local-6989586621679035992"><span class="annot"><span class="annottext">gValidate :: forall a. (:*:) a b a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var hs-var hs-var hs-var">gValidate</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679035993"><span class="annot"><span class="annottext">a a
</span><a href="#local-6989586621679035993"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span id="local-6989586621679035995"><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679035995"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a a -&gt; Validation
forall a. a a -&gt; Validation
forall (f :: * -&gt; *) a. GValidity f =&gt; f a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var">gValidate</span></a></span><span> </span><span class="annot"><span class="annottext">a a
</span><a href="#local-6989586621679035993"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Validation -&gt; Validation -&gt; Validation
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">b a -&gt; Validation
forall a. b a -&gt; Validation
forall (f :: * -&gt; *) a. GValidity f =&gt; f a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var">gValidate</span></a></span><span> </span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679035995"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035311"><span id="local-6989586621679035312"><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035311"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035312"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679035311"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+:</span></span><span> </span><span class="annot"><a href="#local-6989586621679035312"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-590"></span><span>  </span><span id="local-6989586621679036001"><span class="annot"><span class="annottext">gValidate :: forall a. (:+:) a b a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var hs-var hs-var hs-var">gValidate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L1</span></span><span> </span><span id="local-6989586621679036003"><span class="annot"><span class="annottext">a a
</span><a href="#local-6989586621679036003"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a a -&gt; Validation
forall a. a a -&gt; Validation
forall (f :: * -&gt; *) a. GValidity f =&gt; f a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var">gValidate</span></a></span><span> </span><span class="annot"><span class="annottext">a a
</span><a href="#local-6989586621679036003"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-591"></span><span>  </span><span class="annot"><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var">gValidate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">R1</span></span><span> </span><span id="local-6989586621679036005"><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679036005"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b a -&gt; Validation
forall a. b a -&gt; Validation
forall (f :: * -&gt; *) a. GValidity f =&gt; f a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var">gValidate</span></a></span><span> </span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679036005"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-592"></span><span>
</span><span id="line-593"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035309"><span id="local-6989586621679035310"><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035309"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Datatype</span></span><span> </span><span class="annot"><a href="#local-6989586621679035310"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">D</span></span><span> </span><span class="annot"><a href="#local-6989586621679035310"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035309"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-594"></span><span>  </span><span id="local-6989586621679036010"><span class="annot"><span class="annottext">gValidate :: forall a. M1 D c a a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var hs-var hs-var hs-var">gValidate</span></a></span></span><span> </span><span id="local-6989586621679036011"><span class="annot"><span class="annottext">M1 D c a a
</span><a href="#local-6989586621679036011"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a a -&gt; Validation
forall a. a a -&gt; Validation
forall (f :: * -&gt; *) a. GValidity f =&gt; f a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var">gValidate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M1 D c a a -&gt; a a
forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). M1 i c f p -&gt; f p
</span><span class="hs-identifier hs-var">unM1</span></span><span> </span><span class="annot"><span class="annottext">M1 D c a a
</span><a href="#local-6989586621679036011"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035307"><span id="local-6989586621679035308"><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035307"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Constructor</span></span><span> </span><span class="annot"><a href="#local-6989586621679035308"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C</span></span><span> </span><span class="annot"><a href="#local-6989586621679035308"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035307"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-597"></span><span>  </span><span id="local-6989586621679036018"><span class="annot"><span class="annottext">gValidate :: forall a. M1 C c a a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var hs-var hs-var hs-var">gValidate</span></a></span></span><span> </span><span id="local-6989586621679036019"><span class="annot"><span class="annottext">M1 C c a a
</span><a href="#local-6989586621679036019"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a a -&gt; Validation
forall a. a a -&gt; Validation
forall (f :: * -&gt; *) a. GValidity f =&gt; f a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var">gValidate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M1 C c a a -&gt; a a
forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). M1 i c f p -&gt; f p
</span><span class="hs-identifier hs-var">unM1</span></span><span> </span><span class="annot"><span class="annottext">M1 C c a a
</span><a href="#local-6989586621679036019"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Validation -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotateValidation"><span class="hs-operator hs-var">`annotateValidation`</span></a></span><span> </span><span class="annot"><span class="annottext">M1 C c a a -&gt; String
forall {k} (c :: k) k1 (t :: k -&gt; (k1 -&gt; *) -&gt; k1 -&gt; *)
       (f :: k1 -&gt; *) (a :: k1).
Constructor c =&gt;
t c f a -&gt; String
forall k1 (t :: Meta -&gt; (k1 -&gt; *) -&gt; k1 -&gt; *) (f :: k1 -&gt; *)
       (a :: k1).
t c f a -&gt; String
</span><span class="hs-identifier hs-var">conName</span></span><span> </span><span class="annot"><span class="annottext">M1 C c a a
</span><a href="#local-6989586621679036019"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035305"><span id="local-6989586621679035306"><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035305"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Selector</span></span><span> </span><span class="annot"><a href="#local-6989586621679035306"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="annot"><a href="#local-6989586621679035306"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035305"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-600"></span><span>  </span><span id="local-6989586621679036026"><span class="annot"><span class="annottext">gValidate :: forall a. M1 S c a a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var hs-var hs-var hs-var">gValidate</span></a></span></span><span> </span><span id="local-6989586621679036027"><span class="annot"><span class="annottext">M1 S c a a
</span><a href="#local-6989586621679036027"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a a -&gt; Validation
forall a. a a -&gt; Validation
forall (f :: * -&gt; *) a. GValidity f =&gt; f a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var">gValidate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">M1 S c a a -&gt; a a
forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). M1 i c f p -&gt; f p
</span><span class="hs-identifier hs-var">unM1</span></span><span> </span><span class="annot"><span class="annottext">M1 S c a a
</span><a href="#local-6989586621679036027"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Validation -&gt; String -&gt; Validation
</span><a href="Data.Validity.html#annotateValidation"><span class="hs-operator hs-var">`annotateValidation`</span></a></span><span> </span><span class="annot"><span class="annottext">M1 S c a a -&gt; String
forall {k} (s :: k) k1 (t :: k -&gt; (k1 -&gt; *) -&gt; k1 -&gt; *)
       (f :: k1 -&gt; *) (a :: k1).
Selector s =&gt;
t s f a -&gt; String
forall k1 (t :: Meta -&gt; (k1 -&gt; *) -&gt; k1 -&gt; *) (f :: k1 -&gt; *)
       (a :: k1).
t c f a -&gt; String
</span><span class="hs-identifier hs-var">selName</span></span><span> </span><span class="annot"><span class="annottext">M1 S c a a
</span><a href="#local-6989586621679036027"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679035315"><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035315"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Validity.html#GValidity"><span class="hs-identifier hs-type">GValidity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">R</span></span><span> </span><span class="annot"><a href="#local-6989586621679035315"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-603"></span><span>  </span><span id="local-6989586621679036032"><span class="annot"><span class="annottext">gValidate :: forall a. K1 R a a -&gt; Validation
</span><a href="Data.Validity.html#gValidate"><span class="hs-identifier hs-var hs-var hs-var hs-var">gValidate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span id="local-6989586621679036034"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679036034"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Validation
forall a. Validity a =&gt; a -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var">validate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679036034"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-604"></span><span>
</span><span id="line-605"></span><span class="annot"><span class="hs-comment">-- | Check whether a value is valid.</span></span><span>
</span><span id="line-606"></span><span id="local-6989586621679035451"><span class="annot"><a href="Data.Validity.html#isValid"><span class="hs-identifier hs-type">isValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035451"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679035451"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-607"></span><span id="isValid"><span class="annot"><span class="annottext">isValid :: forall a. Validity a =&gt; a -&gt; Bool
</span><a href="Data.Validity.html#isValid"><span class="hs-identifier hs-var hs-var">isValid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either [ValidationChain] a -&gt; Bool
forall a b. Either a b -&gt; Bool
</span><span class="hs-identifier hs-var">isRight</span></span><span> </span><span class="annot"><span class="annottext">(Either [ValidationChain] a -&gt; Bool)
-&gt; (a -&gt; Either [ValidationChain] a) -&gt; a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either [ValidationChain] a
forall a. Validity a =&gt; a -&gt; Either [ValidationChain] a
</span><a href="Data.Validity.html#checkValidity"><span class="hs-identifier hs-var">checkValidity</span></a></span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span class="hs-comment">-- | Check whether a value is not valid.</span><span>
</span><span id="line-610"></span><span class="hs-comment">--</span><span>
</span><span id="line-611"></span><span class="hs-comment">-- &gt; isInvalid = not . isValid</span><span>
</span><span id="line-612"></span><span id="local-6989586621679036037"><span class="annot"><a href="Data.Validity.html#isInvalid"><span class="hs-identifier hs-type">isInvalid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679036037"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679036037"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-613"></span><span id="isInvalid"><span class="annot"><span class="annottext">isInvalid :: forall a. Validity a =&gt; a -&gt; Bool
</span><a href="Data.Validity.html#isInvalid"><span class="hs-identifier hs-var hs-var">isInvalid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (a -&gt; Bool) -&gt; a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
forall a. Validity a =&gt; a -&gt; Bool
</span><a href="Data.Validity.html#isValid"><span class="hs-identifier hs-var">isValid</span></a></span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span class="annot"><span class="hs-comment">-- | Construct a valid element from an unchecked element</span></span><span>
</span><span id="line-616"></span><span id="local-6989586621679035457"><span class="annot"><a href="Data.Validity.html#constructValid"><span class="hs-identifier hs-type">constructValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035457"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679035457"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679035457"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-617"></span><span id="constructValid"><span class="annot"><span class="annottext">constructValid :: forall a. Validity a =&gt; a -&gt; Maybe a
</span><a href="Data.Validity.html#constructValid"><span class="hs-identifier hs-var hs-var">constructValid</span></a></span></span><span> </span><span id="local-6989586621679036042"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679036042"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-618"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
forall a. Validity a =&gt; a -&gt; Bool
</span><a href="Data.Validity.html#isValid"><span class="hs-identifier hs-var">isValid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679036042"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-619"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679036042"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-620"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span class="hs-comment">-- | Construct a valid element from an unchecked element, throwing 'error'</span><span>
</span><span id="line-623"></span><span class="hs-comment">-- on invalid elements.</span><span>
</span><span id="line-624"></span><span id="local-6989586621679035459"><span class="annot"><a href="Data.Validity.html#constructValidUnsafe"><span class="hs-identifier hs-type">constructValidUnsafe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679035459"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035459"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679035459"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679035459"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-625"></span><span id="constructValidUnsafe"><span class="annot"><span class="annottext">constructValidUnsafe :: forall a. (Show a, Validity a) =&gt; a -&gt; a
</span><a href="Data.Validity.html#constructValidUnsafe"><span class="hs-identifier hs-var hs-var">constructValidUnsafe</span></a></span></span><span> </span><span id="local-6989586621679036050"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679036050"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-626"></span><span>  </span><span class="annot"><span class="annottext">a -&gt; Maybe a -&gt; a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; a) -&gt; String -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679036050"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; is not valid&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; a) -&gt; Maybe a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. Validity a =&gt; a -&gt; Maybe a
</span><a href="Data.Validity.html#constructValid"><span class="hs-identifier hs-var">constructValid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679036050"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span class="hs-comment">-- | validate a given value.</span><span>
</span><span id="line-629"></span><span class="hs-comment">--</span><span>
</span><span id="line-630"></span><span class="hs-comment">-- This function returns either all the reasons why the given value is invalid,</span><span>
</span><span id="line-631"></span><span class="hs-comment">-- in the form of a list of 'ValidationChain's, or it returns 'Right' with the</span><span>
</span><span id="line-632"></span><span class="hs-comment">-- input value, as evidence that it is valid.</span><span>
</span><span id="line-633"></span><span class="hs-comment">--</span><span>
</span><span id="line-634"></span><span class="hs-comment">-- Note: You may want to use 'prettyValidation' instead, if you want to</span><span>
</span><span id="line-635"></span><span class="hs-comment">-- display these 'ValidationChain's to a user.</span><span>
</span><span id="line-636"></span><span id="local-6989586621679035455"><span class="annot"><a href="Data.Validity.html#checkValidity"><span class="hs-identifier hs-type">checkValidity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035455"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679035455"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Validity.html#ValidationChain"><span class="hs-identifier hs-type">ValidationChain</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679035455"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-637"></span><span id="checkValidity"><span class="annot"><span class="annottext">checkValidity :: forall a. Validity a =&gt; a -&gt; Either [ValidationChain] a
</span><a href="Data.Validity.html#checkValidity"><span class="hs-identifier hs-var hs-var">checkValidity</span></a></span></span><span> </span><span id="local-6989586621679036053"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679036053"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Validation
forall a. Validity a =&gt; a -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var">validate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679036053"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-639"></span><span>    </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either [ValidationChain] a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679036053"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-640"></span><span>    </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span> </span><span id="local-6989586621679036054"><span class="annot"><span class="annottext">[ValidationChain]
</span><a href="#local-6989586621679036054"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ValidationChain] -&gt; Either [ValidationChain] a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">[ValidationChain]
</span><a href="#local-6989586621679036054"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span class="annot"><span class="hs-comment">-- | Check if a 'Validation' concerns a valid value.</span></span><span>
</span><span id="line-643"></span><span class="annot"><a href="Data.Validity.html#validationIsValid"><span class="hs-identifier hs-type">validationIsValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-644"></span><span id="validationIsValid"><span class="annot"><span class="annottext">validationIsValid :: Validation -&gt; Bool
</span><a href="Data.Validity.html#validationIsValid"><span class="hs-identifier hs-var hs-var">validationIsValid</span></a></span></span><span> </span><span id="local-6989586621679036055"><span class="annot"><span class="annottext">Validation
</span><a href="#local-6989586621679036055"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Validation
</span><a href="#local-6989586621679036055"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-645"></span><span>  </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-646"></span><span>  </span><span class="annot"><span class="annottext">Validation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span class="hs-comment">-- | Validate a given value</span><span>
</span><span id="line-649"></span><span class="hs-comment">--</span><span>
</span><span id="line-650"></span><span class="hs-comment">-- This function will return a nice error if the value is invalid.</span><span>
</span><span id="line-651"></span><span class="hs-comment">-- It will return the original value in 'Right' if it was valid,</span><span>
</span><span id="line-652"></span><span class="hs-comment">-- as evidence that it has been validated.</span><span>
</span><span id="line-653"></span><span id="local-6989586621679035468"><span class="annot"><a href="Data.Validity.html#prettyValidate"><span class="hs-identifier hs-type">prettyValidate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Validity.html#Validity"><span class="hs-identifier hs-type">Validity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679035468"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679035468"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679035468"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-654"></span><span id="prettyValidate"><span class="annot"><span class="annottext">prettyValidate :: forall a. Validity a =&gt; a -&gt; Either String a
</span><a href="Data.Validity.html#prettyValidate"><span class="hs-identifier hs-var hs-var">prettyValidate</span></a></span></span><span> </span><span id="local-6989586621679036058"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679036058"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Validation -&gt; Maybe String
</span><a href="Data.Validity.html#prettyValidation"><span class="hs-identifier hs-var">prettyValidation</span></a></span><span> </span><span class="annot"><span class="annottext">(Validation -&gt; Maybe String) -&gt; Validation -&gt; Maybe String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Validation
forall a. Validity a =&gt; a -&gt; Validation
</span><a href="Data.Validity.html#validate"><span class="hs-identifier hs-var">validate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679036058"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-655"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679036059"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679036059"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679036059"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-656"></span><span>  </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either String a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679036058"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span class="hs-comment">-- | Render a `Validation` in a somewhat pretty way.</span><span>
</span><span id="line-659"></span><span class="hs-comment">--</span><span>
</span><span id="line-660"></span><span class="hs-comment">-- This function will return 'Nothing' if the 'Validation' concerned a valid value.</span><span>
</span><span id="line-661"></span><span class="annot"><a href="Data.Validity.html#prettyValidation"><span class="hs-identifier hs-type">prettyValidation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-662"></span><span id="prettyValidation"><span class="annot"><span class="annottext">prettyValidation :: Validation -&gt; Maybe String
</span><a href="Data.Validity.html#prettyValidation"><span class="hs-identifier hs-var hs-var">prettyValidation</span></a></span></span><span> </span><span id="local-6989586621679036060"><span class="annot"><span class="annottext">Validation
</span><a href="#local-6989586621679036060"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-663"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Validation
</span><a href="#local-6989586621679036060"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-664"></span><span>    </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-665"></span><span>    </span><span class="annot"><a href="Data.Validity.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span> </span><span id="local-6989586621679036061"><span class="annot"><span class="annottext">[ValidationChain]
</span><a href="#local-6989586621679036061"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe String) -&gt; String -&gt; Maybe String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ValidationChain -&gt; String) -&gt; [ValidationChain] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="#local-6989586621679036062"><span class="hs-identifier hs-var">errCascade</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; (ValidationChain -&gt; [String]) -&gt; ValidationChain -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ValidationChain -&gt; [String]
</span><a href="#local-6989586621679036063"><span class="hs-identifier hs-var">toStrings</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ValidationChain]
</span><a href="#local-6989586621679036061"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-666"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-667"></span><span>    </span><span id="local-6989586621679036063"><span class="annot"><span class="annottext">toStrings :: ValidationChain -&gt; [String]
</span><a href="#local-6989586621679036063"><span class="hs-identifier hs-var hs-var">toStrings</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#Violated"><span class="hs-identifier hs-type">Violated</span></a></span><span> </span><span id="local-6989586621679036064"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679036064"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Violated: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679036064"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-668"></span><span>    </span><span class="annot"><a href="#local-6989586621679036063"><span class="hs-identifier hs-var">toStrings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Validity.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span id="local-6989586621679036065"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679036065"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679036066"><span class="annot"><span class="annottext">ValidationChain
</span><a href="#local-6989586621679036066"><span class="hs-identifier hs-var">vc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679036065"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">ValidationChain -&gt; [String]
</span><a href="#local-6989586621679036063"><span class="hs-identifier hs-var">toStrings</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationChain
</span><a href="#local-6989586621679036066"><span class="hs-identifier hs-var">vc</span></a></span><span>
</span><span id="line-669"></span><span>    </span><span id="local-6989586621679036062"><span class="annot"><span class="annottext">errCascade :: [String] -&gt; String
</span><a href="#local-6989586621679036062"><span class="hs-identifier hs-var hs-var">errCascade</span></a></span></span><span> </span><span id="local-6989586621679036072"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679036072"><span class="hs-identifier hs-var">errList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-670"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-671"></span><span>        </span><span class="annot"><span class="annottext">(((Int, String) -&gt; String) -&gt; [(Int, String)] -&gt; [String])
-&gt; [(Int, String)] -&gt; ((Int, String) -&gt; String) -&gt; [String]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((Int, String) -&gt; String) -&gt; [(Int, String)] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; [String] -&gt; [(Int, String)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679036072"><span class="hs-identifier hs-var">errList</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Int, String) -&gt; String) -&gt; [String])
-&gt; ((Int, String) -&gt; String) -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679036073"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679036073"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679036074"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679036074"><span class="hs-identifier hs-var">segment</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-672"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679036073"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-673"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679036074"><span class="hs-identifier hs-var">segment</span></a></span><span>
</span><span id="line-674"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679036073"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\ &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679036074"><span class="hs-identifier hs-var">segment</span></a></span><span>
</span><span id="line-675"></span></pre></body></html>